import{Hb as _s,I as su,K as ou,L as au,P as cu,S as Vr,U as Ne,V as xr,X as uu,Y as Lr,a as ds,b as fs,ba as zt,da as lu,f as jt,ga as Ze,i as ru,j as iu,ka as Mr,l as ps,m as ms,n as gs,na as et,va as hu}from"./chunk-TRTR3GJ4.js";var du=()=>{};var mu=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},ef=function(n){let e=[],t=0,r=0;for(;t<n.length;){let s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){let o=n[t++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){let o=n[t++],c=n[t++],l=n[t++],h=((s&7)<<18|(o&63)<<12|(c&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],c=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return e.join("")},Fr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){let o=n[s],c=s+1<n.length,l=c?n[s+1]:0,h=s+2<n.length,f=h?n[s+2]:0,v=o>>2,w=(o&3)<<4|l>>4,b=(l&15)<<2|f>>6,C=f&63;h||(C=64,c||(b=64)),r.push(t[v],t[w],t[b],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(mu(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ef(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){let o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;let f=s<n.length?t[n.charAt(s)]:64;++s;let w=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||f==null||w==null)throw new vs;let b=o<<2|l>>4;if(r.push(b),f!==64){let C=l<<4&240|f>>2;if(r.push(C),w!==64){let k=f<<6&192|w;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},vs=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},tf=function(n){let e=mu(n);return Fr.encodeByteArray(e,!0)},Un=function(n){return tf(n).replace(/\./g,"")},Ur=function(n){try{return Fr.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Es(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var nf=()=>Es().__FIREBASE_DEFAULTS__,rf=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},sf=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ur(n[1]);return e&&JSON.parse(e)},Br=()=>{try{return du()||nf()||rf()||sf()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},gu=n=>{var e,t;return(t=(e=Br())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},_u=n=>{let e=gu(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ws=()=>{var n;return(n=Br())===null||n===void 0?void 0:n.config},yu=n=>{var e;return(e=Br())===null||e===void 0?void 0:e[`_${n}`]};var pt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function mt(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ts(n){return(await fetch(n,{credentials:"include"})).ok}function vu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let c=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Un(JSON.stringify(t)),Un(JSON.stringify(c)),""].join(".")}var Fn={};function of(){let n={prod:[],emulator:[]};for(let e of Object.keys(Fn))Fn[e]?n.emulator.push(e):n.prod.push(e);return n}function af(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var fu=!1;function As(n,e){if(typeof window>"u"||typeof document>"u"||!mt(window.location.host)||Fn[n]===e||Fn[n]||fu)return;Fn[n]=e;function t(b){return`__firebase__banner__${b}`}let r="__firebase__banner",o=of().prod.length>0;function c(){let b=document.getElementById(r);b&&b.remove()}function l(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){let b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{fu=!0,c()},b}function v(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function w(){let b=af(r),C=t("text"),k=document.getElementById(C)||document.createElement("span"),V=t("learnmore"),O=document.getElementById(V)||document.createElement("a"),z=t("preprendIcon"),F=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){let j=b.element;l(j),v(O,V);let Y=f();h(F,z),j.append(F,k,O,Y),document.body.appendChild(j)}o?(k.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function Ie(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Iu(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ie())}function cf(){var n;let e=(n=Br())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Eu(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wu(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Tu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Au(){return!cf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Bn(){try{return typeof indexedDB=="object"}catch{return!1}}function bu(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var uf="FirebaseError",Ae=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=uf,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pe.prototype.create)}},Pe=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],c=o?lf(o,r):"Error",l=`${this.serviceName}: ${c} (${s}).`;return new Ae(s,l,r)}};function lf(n,e){return n.replace(hf,(t,r)=>{let s=e[r];return s!=null?String(s):`<${r}?>`})}var hf=/\{\$([^}]+)}/g;function gt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let s of t){if(!r.includes(s))return!1;let o=n[s],c=e[s];if(pu(o)&&pu(c)){if(!gt(o,c))return!1}else if(o!==c)return!1}for(let s of r)if(!t.includes(s))return!1;return!0}function pu(n){return n!==null&&typeof n=="object"}function bs(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Su(n,e){let t=new Is(n,e);return t.subscribe.bind(t)}var Is=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");df(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=ys),s.error===void 0&&(s.error=ys),s.complete===void 0&&(s.complete=ys);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function df(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ys(){}var vy=14400*1e3;function be(n){return n&&n._delegate?n._delegate:n}var ye=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var _t="[DEFAULT]";var Ss=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new pt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),s=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pf(e))try{this.getOrInitializeService({instanceIdentifier:_t})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let s=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=_t){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_t){return this.instances.has(e)}getOptions(e=_t){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,c]of this.instancesDeferred.entries()){let l=this.normalizeInstanceIdentifier(o);r===l&&c.resolve(s)}return s}onInit(e,t){var r;let s=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(s,o);let c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ff(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_t){return this.component?this.component.multipleInstances?e:_t:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function ff(n){return n===_t?void 0:n}function pf(n){return n.instantiationMode==="EAGER"}var qr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ss(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var mf=[],M=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(M||{}),gf={debug:M.DEBUG,verbose:M.VERBOSE,info:M.INFO,warn:M.WARN,error:M.ERROR,silent:M.SILENT},_f=M.INFO,yf={[M.DEBUG]:"log",[M.VERBOSE]:"log",[M.INFO]:"info",[M.WARN]:"warn",[M.ERROR]:"error"},vf=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),s=yf[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Oe=class{constructor(e){this.name=e,this._logLevel=_f,this._logHandler=vf,this._userLogHandler=null,mf.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in M))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gf[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,M.DEBUG,...e),this._logHandler(this,M.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,M.VERBOSE,...e),this._logHandler(this,M.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,M.INFO,...e),this._logHandler(this,M.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,M.WARN,...e),this._logHandler(this,M.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,M.ERROR,...e),this._logHandler(this,M.ERROR,...e)}};var If=(n,e)=>e.some(t=>n instanceof t),Ru,Pu;function Ef(){return Ru||(Ru=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wf(){return Pu||(Pu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Cu=new WeakMap,Ps=new WeakMap,ku=new WeakMap,Rs=new WeakMap,ks=new WeakMap;function Tf(n){let e=new Promise((t,r)=>{let s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(Ve(n.result)),s()},c=()=>{r(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Cu.set(t,n)}).catch(()=>{}),ks.set(e,n),e}function Af(n){if(Ps.has(n))return;let e=new Promise((t,r)=>{let s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),s()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});Ps.set(n,e)}var Cs={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ps.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ku.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ve(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Du(n){Cs=n(Cs)}function bf(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call($r(this),e,...t);return ku.set(r,e.sort?e.sort():[e]),Ve(r)}:wf().includes(n)?function(...e){return n.apply($r(this),e),Ve(Cu.get(this))}:function(...e){return Ve(n.apply($r(this),e))}}function Sf(n){return typeof n=="function"?bf(n):(n instanceof IDBTransaction&&Af(n),If(n,Ef())?new Proxy(n,Cs):n)}function Ve(n){if(n instanceof IDBRequest)return Tf(n);if(Rs.has(n))return Rs.get(n);let e=Sf(n);return e!==n&&(Rs.set(n,e),ks.set(e,n)),e}var $r=n=>ks.get(n);function Ou(n,e,{blocked:t,upgrade:r,blocking:s,terminated:o}={}){let c=indexedDB.open(n,e),l=Ve(c);return r&&c.addEventListener("upgradeneeded",h=>{r(Ve(c.result),h.oldVersion,h.newVersion,Ve(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}var Rf=["get","getKey","getAll","getAllKeys","count"],Pf=["put","add","delete","clear"],Ds=new Map;function Nu(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ds.get(e))return Ds.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,s=Pf.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Rf.includes(t)))return;let o=async function(c,...l){let h=this.transaction(c,s?"readwrite":"readonly"),f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),s&&h.done]))[0]};return Ds.set(e,o),o}Du(n=>fs(ds({},n),{get:(e,t,r)=>Nu(e,t)||n.get(e,t,r),has:(e,t)=>!!Nu(e,t)||n.has(e,t)}));var Os=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cf(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Cf(n){let e=n.getComponent();return e?.type==="VERSION"}var Vs="@firebase/app",Vu="0.13.2";var $e=new Oe("@firebase/app"),kf="@firebase/app-compat",Df="@firebase/analytics-compat",Nf="@firebase/analytics",Of="@firebase/app-check-compat",Vf="@firebase/app-check",xf="@firebase/auth",Lf="@firebase/auth-compat",Mf="@firebase/database",Ff="@firebase/data-connect",Uf="@firebase/database-compat",Bf="@firebase/functions",qf="@firebase/functions-compat",$f="@firebase/installations",jf="@firebase/installations-compat",zf="@firebase/messaging",Wf="@firebase/messaging-compat",Gf="@firebase/performance",Kf="@firebase/performance-compat",Hf="@firebase/remote-config",Qf="@firebase/remote-config-compat",Jf="@firebase/storage",Yf="@firebase/storage-compat",Xf="@firebase/firestore",Zf="@firebase/ai",ep="@firebase/firestore-compat",tp="firebase",np="11.10.0";var xs="[DEFAULT]",rp={[Vs]:"fire-core",[kf]:"fire-core-compat",[Nf]:"fire-analytics",[Df]:"fire-analytics-compat",[Vf]:"fire-app-check",[Of]:"fire-app-check-compat",[xf]:"fire-auth",[Lf]:"fire-auth-compat",[Mf]:"fire-rtdb",[Ff]:"fire-data-connect",[Uf]:"fire-rtdb-compat",[Bf]:"fire-fn",[qf]:"fire-fn-compat",[$f]:"fire-iid",[jf]:"fire-iid-compat",[zf]:"fire-fcm",[Wf]:"fire-fcm-compat",[Gf]:"fire-perf",[Kf]:"fire-perf-compat",[Hf]:"fire-rc",[Qf]:"fire-rc-compat",[Jf]:"fire-gcs",[Yf]:"fire-gcs-compat",[Xf]:"fire-fst",[ep]:"fire-fst-compat",[Zf]:"fire-vertex","fire-js":"fire-js",[tp]:"fire-js-all"};var qn=new Map,ip=new Map,Ls=new Map;function xu(n,e){try{n.container.addComponent(e)}catch(t){$e.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ce(n){let e=n.name;if(Ls.has(e))return $e.debug(`There were multiple attempts to register component ${e}.`),!1;Ls.set(e,n);for(let t of qn.values())xu(t,n);for(let t of ip.values())xu(t,n);return!0}function jr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function je(n){return n==null?!1:n.settings!==void 0}var sp={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tt=new Pe("app","Firebase",sp);var Ms=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ye("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tt.create("app-deleted",{appName:this._name})}};var Wt=np;function Bs(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:xs,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw tt.create("bad-app-name",{appName:String(s)});if(t||(t=ws()),!t)throw tt.create("no-options");let o=qn.get(s);if(o){if(gt(t,o.options)&&gt(r,o.config))return o;throw tt.create("duplicate-app",{appName:s})}let c=new qr(s);for(let h of Ls.values())c.addComponent(h);let l=new Ms(t,r,c);return qn.set(s,l),l}function Gt(n=xs){let e=qn.get(n);if(!e&&n===xs&&ws())return Bs();if(!e)throw tt.create("no-app",{appName:n});return e}function zr(){return Array.from(qn.values())}function X(n,e,t){var r;let s=(r=rp[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);let o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){let l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&l.push("and"),c&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$e.warn(l.join(" "));return}Ce(new ye(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}var op="firebase-heartbeat-database",ap=1,$n="firebase-heartbeat-store",Ns=null;function Uu(){return Ns||(Ns=Ou(op,ap,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($n)}catch(t){console.warn(t)}}}}).catch(n=>{throw tt.create("idb-open",{originalErrorMessage:n.message})})),Ns}async function cp(n){try{let t=(await Uu()).transaction($n),r=await t.objectStore($n).get(Bu(n));return await t.done,r}catch(e){if(e instanceof Ae)$e.warn(e.message);else{let t=tt.create("idb-get",{originalErrorMessage:e?.message});$e.warn(t.message)}}}async function Lu(n,e){try{let r=(await Uu()).transaction($n,"readwrite");await r.objectStore($n).put(e,Bu(n)),await r.done}catch(t){if(t instanceof Ae)$e.warn(t.message);else{let r=tt.create("idb-set",{originalErrorMessage:t?.message});$e.warn(r.message)}}}function Bu(n){return`${n.name}!${n.options.appId}`}var up=1024,lp=30,Fs=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Us(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Mu();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>lp){let c=dp(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){$e.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Mu(),{heartbeatsToSend:r,unsentEntries:s}=hp(this._heartbeatsCache.heartbeats),o=Un(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return $e.warn(t),""}}};function Mu(){return new Date().toISOString().substring(0,10)}function hp(n,e=up){let t=[],r=n.slice();for(let s of n){let o=t.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),Fu(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Fu(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Us=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Bn()?bu().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await cp(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let s=await this.read();return Lu(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let s=await this.read();return Lu(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}};function Fu(n){return Un(JSON.stringify({version:2,heartbeats:n})).length}function dp(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function fp(n){Ce(new ye("platform-logger",e=>new Os(e),"PRIVATE")),Ce(new ye("heartbeat",e=>new Fs(e),"PRIVATE")),X(Vs,Vu,n),X(Vs,Vu,"esm2017"),X("fire-js","")}fp("");var pp="firebase",mp="11.10.0";X(pp,mp,"app");function Xy(n){n||(n=Ne(lu));let e=new jt(t=>{if(n.destroyed){t.next();return}return n.onDestroy(t.next.bind(t))});return t=>t.pipe(su(e))}function qu(n){n===void 0&&(n=Ne(zt));let e=n.get(Mr);return t=>new jt(r=>{let s=e.add(),o=!1;function c(){o||(s(),o=!0)}let l=t.subscribe({next:h=>{r.next(h),c()},complete:()=>{r.complete(),c()},error:h=>{r.error(h),c()}});return l.add(()=>{r.unsubscribe(),c()}),l})}var vt=new ou("ANGULARFIRE2_VERSION");function Gr(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(c=>c.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ht=(n,e)=>{let t=e?[e]:zr(),r=[];return t.forEach(s=>{s.container.getProvider(n).instances.forEach(c=>{r.includes(c)||r.push(c)})}),r},Kt=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Kt||{}),$u=_s()&&typeof Zone<"u"?Kt.WARN:Kt.SILENT;var Wr=class{zone;delegate;constructor(e,t=iu){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let s=this.zone,o=function(c){s?s.runGuarded(()=>{e.apply(this,[c])}):e.apply(this,[c])};return this.delegate.schedule(o,t,r)}},It=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=Ne(Ze);this.outsideAngular=t.runOutsideAngular(()=>new Wr(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Wr(typeof Zone>"u"?void 0:Zone.current,ru))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=cu({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ju=!1;function gp(n,e){!ju&&($u>Kt.SILENT||_s())&&(ju=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),$u>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function _p(n){let e=Ne(Ze,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function yt(n){let e=Ne(Ze,{optional:!0});return e?e.run(()=>n()):n()}var yp=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Lr(t,()=>yt(()=>n.apply(void 0,r)))),nt=(n,e,t)=>(t||=e?Kt.WARN:Kt.VERBOSE,function(){let r,s=arguments,o,c,l;try{o=Ne(It),c=Ne(Mr),l=Ne(uu)}catch{return gp(n,t),n.apply(this,s)}for(let f=0;f<arguments.length;f++)typeof s[f]=="function"&&(e&&(r||=yt(()=>c.add())),s[f]=yp(s[f],r,l));let h=_p(()=>n.apply(this,s));return e?h instanceof jt?h.pipe(gs(o.outsideAngular),ms(o.insideAngular),qu(l)):h instanceof Promise?yt(()=>{let f=c.add();return new Promise((v,w)=>{h.then(b=>Lr(l,()=>yt(()=>v(b))),b=>Lr(l,()=>yt(()=>w(b)))).finally(f)})}):typeof h=="function"&&r?function(){return setTimeout(r,0),h.apply(this,arguments)}:yt(()=>h):h instanceof jt?h.pipe(gs(o.outsideAngular),ms(o.insideAngular)):yt(()=>h)});var Et=class{constructor(e){return e}},jn=class{constructor(){return zr()}};function vp(n){return n&&n.length===1?n[0]:new Et(Gt())}var qs=new Vr("angularfire2._apps"),Ip={provide:Et,useFactory:vp,deps:[[new et,qs]]},Ep={provide:jn,deps:[[new et,qs]]};function wp(n){return(e,t)=>{let r=t.get(hu);X("angularfire",vt.full,"core"),X("angularfire",vt.full,"app"),X("angular",au.full,r.toString());let s=e.runOutsideAngular(()=>n(t));return new Et(s)}}function yv(n,...e){return xr([Ip,Ep,{provide:qs,useFactory:wp(n),multi:!0,deps:[Ze,zt,It,...e]}])}var vv=nt(Bs,!0);var Tp=new Map,Ap={activated:!1,tokenObservers:[]},bp={initialized:!1,enabled:!1};function ke(n){return Tp.get(n)||Object.assign({},Ap)}function Ku(){return bp}var Sp="https://content-firebaseappcheck.googleapis.com/v1";var Rp="exchangeDebugToken",zu={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},Pv=1440*60*1e3;var zs=class{constructor(e,t,r,s,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=s,s>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new pt,this.pending.promise.catch(t=>{}),await Pp(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new pt,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Pp(n){return new Promise(e=>{setTimeout(e,n)})}var Cp={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},rt=new Pe("appCheck","AppCheck",Cp);function Hu(n){if(!ke(n).activated)throw rt.create("use-before-activation",{appName:n.name})}async function Qu({url:n,body:e},t){let r={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let w=await s.getHeartbeatsHeader();w&&(r["X-Firebase-Client"]=w)}let o={method:"POST",body:JSON.stringify(e),headers:r},c;try{c=await fetch(n,o)}catch(w){throw rt.create("fetch-network-error",{originalErrorMessage:w?.message})}if(c.status!==200)throw rt.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(w){throw rt.create("fetch-parse-error",{originalErrorMessage:w?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw rt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let f=Number(h[1])*1e3,v=Date.now();return{token:l.token,expireTimeMillis:v+f,issuedAtTimeMillis:v}}function Ju(n,e){let{projectId:t,appId:r,apiKey:s}=n.options;return{url:`${Sp}/projects/${t}/apps/${r}:${Rp}?key=${s}`,body:{debug_token:e}}}var kp="firebase-app-check-database",Dp=1,Ws="firebase-app-check-store";var Kr=null;function Np(){return Kr||(Kr=new Promise((n,e)=>{try{let t=indexedDB.open(kp,Dp);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var s;e(rt.create("storage-open",{originalErrorMessage:(s=r.target.error)===null||s===void 0?void 0:s.message}))},t.onupgradeneeded=r=>{let s=r.target.result;switch(r.oldVersion){case 0:s.createObjectStore(Ws,{keyPath:"compositeKey"})}}}catch(t){e(rt.create("storage-open",{originalErrorMessage:t?.message}))}}),Kr)}function Op(n,e){return Vp(xp(n),e)}async function Vp(n,e){let r=(await Np()).transaction(Ws,"readwrite"),o=r.objectStore(Ws).put({compositeKey:n,value:e});return new Promise((c,l)=>{o.onsuccess=h=>{c()},r.onerror=h=>{var f;l(rt.create("storage-set",{originalErrorMessage:(f=h.target.error)===null||f===void 0?void 0:f.message}))}})}function xp(n){return`${n.options.appId}-${n.name}`}var zn=new Oe("@firebase/app-check");function $s(n,e){return Bn()?Op(n,e).catch(t=>{zn.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Yu(){return Ku().enabled}async function Xu(){let n=Ku();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var Lp={error:"UNKNOWN_ERROR"};function Mp(n){return Fr.encodeString(JSON.stringify(n),!1)}async function Gs(n,e=!1,t=!1){let r=n.app;Hu(r);let s=ke(r),o=s.token,c;if(o&&!Wn(o)&&(s.token=void 0,o=void 0),!o){let f=await s.cachedTokenPromise;f&&(Wn(f)?o=f:await $s(r,void 0))}if(!e&&o&&Wn(o))return{token:o.token};let l=!1;if(Yu())try{s.exchangeTokenPromise||(s.exchangeTokenPromise=Qu(Ju(r,await Xu()),n.heartbeatServiceProvider).finally(()=>{s.exchangeTokenPromise=void 0}),l=!0);let f=await s.exchangeTokenPromise;return await $s(r,f),s.token=f,{token:f.token}}catch(f){return f.code==="appCheck/throttled"||f.code==="appCheck/initial-throttle"?zn.warn(f.message):t&&zn.error(f),js(f)}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().finally(()=>{s.exchangeTokenPromise=void 0}),l=!0),o=await ke(r).exchangeTokenPromise}catch(f){f.code==="appCheck/throttled"||f.code==="appCheck/initial-throttle"?zn.warn(f.message):t&&zn.error(f),c=f}let h;return o?c?Wn(o)?h={token:o.token,internalError:c}:h=js(c):(h={token:o.token},s.token=o,await $s(r,o)):h=js(c),l&&qp(r,h),h}async function Fp(n){let e=n.app;Hu(e);let{provider:t}=ke(e);if(Yu()){let r=await Xu(),{token:s}=await Qu(Ju(e,r),n.heartbeatServiceProvider);return{token:s}}else{let{token:r}=await t.getToken();return{token:r}}}function Up(n,e,t,r){let{app:s}=n,o=ke(s),c={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,c],o.token&&Wn(o.token)){let l=o.token;Promise.resolve().then(()=>{t({token:l.token}),Wu(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Wu(n))}function Zu(n,e){let t=ke(n),r=t.tokenObservers.filter(s=>s.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Wu(n){let{app:e}=n,t=ke(e),r=t.tokenRefresher;r||(r=Bp(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Bp(n){let{app:e}=n;return new zs(async()=>{let t=ke(e),r;if(t.token?r=await Gs(n,!0):r=await Gs(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=ke(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,s=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},zu.RETRIAL_MIN_WAIT,zu.RETRIAL_MAX_WAIT)}function qp(n,e){let t=ke(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Wn(n){return n.expireTimeMillis-Date.now()>0}function js(n){return{token:Mp(Lp),error:n}}var Ks=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ke(this.app);for(let t of e)Zu(this.app,t.next);return Promise.resolve()}};function $p(n,e){return new Ks(n,e)}function jp(n){return{getToken:e=>Gs(n,e),getLimitedUseToken:()=>Fp(n),addTokenListener:e=>Up(n,"INTERNAL",e),removeTokenListener:e=>Zu(n.app,e)}}var zp="@firebase/app-check",Wp="0.10.1";var Gp="app-check",Gu="app-check-internal";function Kp(){Ce(new ye(Gp,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return $p(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Gu).initialize()})),Ce(new ye(Gu,n=>{let e=n.getProvider("app-check").getImmediate();return jp(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),X(zp,Wp)}Kp();var Hp="app-check";var Hr=class{constructor(){return Ht(Hp)}};var Qp=["localhost","0.0.0.0","127.0.0.1"],Bv=typeof window<"u"&&Qp.includes(window.location.hostname);function al(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var cl=al,ul=new Pe("auth","Firebase",al());var Xr=new Oe("@firebase/auth");function Jp(n,...e){Xr.logLevel<=M.WARN&&Xr.warn(`Auth (${Wt}): ${n}`,...e)}function Jr(n,...e){Xr.logLevel<=M.ERROR&&Xr.error(`Auth (${Wt}): ${n}`,...e)}function el(n,...e){throw so(n,...e)}function io(n,...e){return so(n,...e)}function ll(n,e,t){let r=Object.assign(Object.assign({},cl()),{[e]:t});return new Pe("auth","Firebase",r).create(e,{appName:n.name})}function Yr(n){return ll(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function so(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ul.create(n,...e)}function $(n,e,...t){if(!n)throw so(e,...t)}function Gn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Jr(e),new Error(e)}function Zr(n,e){n||Gn(e)}function Yp(){return tl()==="http:"||tl()==="https:"}function tl(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Xp(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Yp()||wu()||"connection"in navigator)?navigator.onLine:!0}function Zp(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var At=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zr(t>e,"Short delay should be less than long delay!"),this.isMobile=Iu()||Tu()}get(){return Xp()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function em(n,e){Zr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ei=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var tm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var nm=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rm=new At(3e4,6e4);function hl(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function si(n,e,t,r,s={}){return dl(n,s,async()=>{let o={},c={};r&&(e==="GET"?c=r:o={body:JSON.stringify(r)});let l=bs(Object.assign({key:n.config.apiKey},c)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);let f=Object.assign({method:e,headers:h},o);return Eu()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&mt(n.emulatorConfig.host)&&(f.credentials="include"),ei.fetch()(await fl(n,n.config.apiHost,t,l),f)})}async function dl(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},tm),e);try{let s=new Js(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();let c=await o.json();if("needConfirmation"in c)throw Qr(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{let l=o.ok?c.errorMessage:c.error.message,[h,f]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qr(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Qr(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw Qr(n,"user-disabled",c);let v=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw ll(n,v,f);el(n,v)}}catch(s){if(s instanceof Ae)throw s;el(n,"network-request-failed",{message:String(s)})}}async function fl(n,e,t,r){let s=`${e}${t}?${r}`,o=n,c=o.config.emulator?em(n.config,s):`${n.config.apiScheme}://${s}`;return nm.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}var Js=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(io(this.auth,"network-request-failed")),rm.get())})}};function Qr(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let s=io(n,e,r);return s.customData._tokenResponse=t,s}async function im(n,e){return si(n,"POST","/v1/accounts:delete",e)}async function ti(n,e){return si(n,"POST","/v1/accounts:lookup",e)}function Kn(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oo(n,e=!1){let t=be(n),r=await t.getIdToken(e),s=pl(r);$(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");let o=typeof s.firebase=="object"?s.firebase:void 0,c=o?.sign_in_provider;return{claims:s,token:r,authTime:Kn(Hs(s.auth_time)),issuedAtTime:Kn(Hs(s.iat)),expirationTime:Kn(Hs(s.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Hs(n){return Number(n)*1e3}function pl(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Jr("JWT malformed, contained fewer than 3 sections"),null;try{let s=Ur(t);return s?JSON.parse(s):(Jr("Failed to decode base64 JWT payload"),null)}catch(s){return Jr("Caught error parsing JWT payload as JSON",s?.toString()),null}}function nl(n){let e=pl(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ys(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ae&&sm(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function sm({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Xs=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Qn=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kn(this.lastLoginAt),this.creationTime=Kn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function ni(n){var e;let t=n.auth,r=await n.getIdToken(),s=await Ys(n,ti(t,{idToken:r}));$(s?.users.length,t,"internal-error");let o=s.users[0];n._notifyReloadListener(o);let c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?ml(o.providerUserInfo):[],l=om(n.providerData,c),h=n.isAnonymous,f=!(n.email&&o.passwordHash)&&!l?.length,v=h?f:!1,w={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Qn(o.createdAt,o.lastLoginAt),isAnonymous:v};Object.assign(n,w)}async function ao(n){let e=be(n);await ni(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function om(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function ml(n){return n.map(e=>{var{providerId:t}=e,r=ps(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function am(n,e){let t=await dl(n,{},async()=>{let r=bs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,c=await fl(n,s,"/v1/token",`key=${o}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";let h={method:"POST",headers:l,body:r};return n.emulatorConfig&&mt(n.emulatorConfig.host)&&(h.credentials="include"),ei.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function cm(n,e){return si(n,"POST","/v2/accounts:revokeToken",hl(n,e))}var Hn=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nl(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=nl(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:s,expiresIn:o}=await am(e,t);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:s,expirationTime:o}=t,c=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),s&&($(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),o&&($(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Gn("not implemented")}};function it(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var wt=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,o=ps(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Qn(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){let t=await Ys(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return oo(this,e)}reload(){return ao(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ni(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(je(this.auth.app))return Promise.reject(Yr(this.auth));let e=await this.getIdToken();return await Ys(this,im(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,o,c,l,h,f,v;let w=(r=t.displayName)!==null&&r!==void 0?r:void 0,b=(s=t.email)!==null&&s!==void 0?s:void 0,C=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,k=(c=t.photoURL)!==null&&c!==void 0?c:void 0,V=(l=t.tenantId)!==null&&l!==void 0?l:void 0,O=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,z=(f=t.createdAt)!==null&&f!==void 0?f:void 0,F=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:j,emailVerified:Y,isAnonymous:De,providerData:se,stsTokenManager:I}=t;$(j&&I,e,"internal-error");let p=Hn.fromJSON(this.name,I);$(typeof j=="string",e,"internal-error"),it(w,e.name),it(b,e.name),$(typeof Y=="boolean",e,"internal-error"),$(typeof De=="boolean",e,"internal-error"),it(C,e.name),it(k,e.name),it(V,e.name),it(O,e.name),it(z,e.name),it(F,e.name);let g=new n({uid:j,auth:e,email:b,emailVerified:Y,displayName:w,isAnonymous:De,photoURL:k,phoneNumber:C,tenantId:V,stsTokenManager:p,createdAt:z,lastLoginAt:F});return se&&Array.isArray(se)&&(g.providerData=se.map(_=>Object.assign({},_))),O&&(g._redirectEventId=O),g}static async _fromIdTokenResponse(e,t,r=!1){let s=new Hn;s.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ni(o),o}static async _fromGetAccountInfoResponse(e,t,r){let s=t.users[0];$(s.localId!==void 0,"internal-error");let o=s.providerUserInfo!==void 0?ml(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!o?.length,l=new Hn;l.updateFromIdToken(r);let h=new n({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:c}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Qn(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(h,f),h}};var rl=new Map;function Tt(n){Zr(n instanceof Function,"Expected a class definition");let e=rl.get(n);return e?(Zr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,rl.set(n,e),e)}var um=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Zs=um;function Qs(n,e,t){return`firebase:${n}:${e}:${t}`}var ri=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:s,name:o}=this.auth;this.fullUserKey=Qs(this.userKey,s.apiKey,o),this.fullPersistenceKey=Qs("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await ti(this.auth,{idToken:e}).catch(()=>{});return t?wt._fromGetAccountInfoResponse(this.auth,t,e):null}return wt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(Tt(Zs),e,r);let s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f),o=s[0]||Tt(Zs),c=Qs(r,e.config.apiKey,e.name),l=null;for(let f of t)try{let v=await f._get(c);if(v){let w;if(typeof v=="string"){let b=await ti(e,{idToken:v}).catch(()=>{});if(!b)break;w=await wt._fromGetAccountInfoResponse(e,b,v)}else w=wt._fromJSON(e,v);f!==o&&(l=w),o=f;break}}catch{}let h=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],l&&await o._set(c,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(c)}catch{}})),new n(o,e,r))}};function il(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mm(e))return"Blackberry";if(gm(e))return"Webos";if(hm(e))return"Safari";if((e.includes("chrome/")||dm(e))&&!e.includes("edge/"))return"Chrome";if(pm(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function lm(n=Ie()){return/firefox\//i.test(n)}function hm(n=Ie()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dm(n=Ie()){return/crios\//i.test(n)}function fm(n=Ie()){return/iemobile/i.test(n)}function pm(n=Ie()){return/android/i.test(n)}function mm(n=Ie()){return/blackberry/i.test(n)}function gm(n=Ie()){return/webos/i.test(n)}function gl(n,e=[]){let t;switch(n){case"Browser":t=il(Ie());break;case"Worker":t=`${il(Ie())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wt}/${r}`}var eo=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((c,l)=>{try{let h=e(o);c(h)}catch(h){l(h)}});r.onAbort=t,this.queue.push(r);let s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function _m(n,e={}){return si(n,"GET","/v2/passwordPolicy",hl(n,e))}var ym=6,to=class{constructor(e){var t,r,s,o;let c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:ym,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,o,c,l;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(s=h.containsLowercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var no=class{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ii(this),this.idTokenSubscription=new ii(this),this.beforeStateQueue=new eo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ul,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Tt(t)),this._initializationPromise=this.queue(async()=>{var r,s,o;if(!this._deleted&&(this.persistenceManager=await ri.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await ti(this,{idToken:e}),r=await wt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(je(this.app)){let c=this.app.settings.authIdToken;return c?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(l,l))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),s=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=s?._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===l)&&h?.user&&(s=h.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ni(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zp()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(je(this.app))return Promise.reject(Yr(this));let t=e?be(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return je(this.app)?Promise.reject(Yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return je(this.app)?Promise.reject(Yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Tt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await _m(this),t=new to(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Pe("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await cm(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Tt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=await ri.create(this,[Tt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),c=!1,l=this._isInitialized?Promise.resolve():this._initializationPromise;if($(l,this,"internal-error"),l.then(()=>{c||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,s);return()=>{c=!0,h()}}else{let h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gl(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(je(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Jp(`Error while retrieving App Check token: ${t.error}`),t?.token}};function vm(n){return be(n)}var ii=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Su(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Im={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Em(n){Im=n}function wm(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Tm(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Tt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var Xv=wm("rcb"),Zv=new At(3e4,6e4);var eI=new At(2e3,1e4);var tI=600*1e3;var nI=new At(3e4,6e4);var rI=new At(5e3,15e3);var iI=encodeURIComponent("fac");var sl="@firebase/auth",ol="1.10.8";var ro=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Am(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bm(n){Ce(new ye("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:l}=r.options;$(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:c,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gl(n)},f=new no(r,s,o,h);return Tm(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ce(new ye("auth-internal",e=>{let t=vm(e.getProvider("auth").getImmediate());return(r=>new ro(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),X(sl,ol,Am(n)),X(sl,ol,"esm2017")}var Sm=300,sI=yu("authIdTokenMaxAge")||Sm;function Rm(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Em({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{let o=io("internal-error");o.customData=s,t(o)},r.type="text/javascript",r.charset="UTF-8",Rm().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bm("Browser");var bg="auth";var oi=class{constructor(){return Ht(bg)}};var _l=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yl={};var ai,vl;(function(){var n;function e(I,p){function g(){}g.prototype=p.prototype,I.D=p.prototype,I.prototype=new g,I.prototype.constructor=I,I.C=function(_,y,T){for(var m=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)m[Ue-2]=arguments[Ue];return p.prototype[y].apply(_,m)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,p,g){g||(g=0);var _=Array(16);if(typeof p=="string")for(var y=0;16>y;++y)_[y]=p.charCodeAt(g++)|p.charCodeAt(g++)<<8|p.charCodeAt(g++)<<16|p.charCodeAt(g++)<<24;else for(y=0;16>y;++y)_[y]=p[g++]|p[g++]<<8|p[g++]<<16|p[g++]<<24;p=I.g[0],g=I.g[1],y=I.g[2];var T=I.g[3],m=p+(T^g&(y^T))+_[0]+3614090360&4294967295;p=g+(m<<7&4294967295|m>>>25),m=T+(y^p&(g^y))+_[1]+3905402710&4294967295,T=p+(m<<12&4294967295|m>>>20),m=y+(g^T&(p^g))+_[2]+606105819&4294967295,y=T+(m<<17&4294967295|m>>>15),m=g+(p^y&(T^p))+_[3]+3250441966&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(T^g&(y^T))+_[4]+4118548399&4294967295,p=g+(m<<7&4294967295|m>>>25),m=T+(y^p&(g^y))+_[5]+1200080426&4294967295,T=p+(m<<12&4294967295|m>>>20),m=y+(g^T&(p^g))+_[6]+2821735955&4294967295,y=T+(m<<17&4294967295|m>>>15),m=g+(p^y&(T^p))+_[7]+4249261313&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(T^g&(y^T))+_[8]+1770035416&4294967295,p=g+(m<<7&4294967295|m>>>25),m=T+(y^p&(g^y))+_[9]+2336552879&4294967295,T=p+(m<<12&4294967295|m>>>20),m=y+(g^T&(p^g))+_[10]+4294925233&4294967295,y=T+(m<<17&4294967295|m>>>15),m=g+(p^y&(T^p))+_[11]+2304563134&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(T^g&(y^T))+_[12]+1804603682&4294967295,p=g+(m<<7&4294967295|m>>>25),m=T+(y^p&(g^y))+_[13]+4254626195&4294967295,T=p+(m<<12&4294967295|m>>>20),m=y+(g^T&(p^g))+_[14]+2792965006&4294967295,y=T+(m<<17&4294967295|m>>>15),m=g+(p^y&(T^p))+_[15]+1236535329&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(y^T&(g^y))+_[1]+4129170786&4294967295,p=g+(m<<5&4294967295|m>>>27),m=T+(g^y&(p^g))+_[6]+3225465664&4294967295,T=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(T^p))+_[11]+643717713&4294967295,y=T+(m<<14&4294967295|m>>>18),m=g+(T^p&(y^T))+_[0]+3921069994&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^T&(g^y))+_[5]+3593408605&4294967295,p=g+(m<<5&4294967295|m>>>27),m=T+(g^y&(p^g))+_[10]+38016083&4294967295,T=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(T^p))+_[15]+3634488961&4294967295,y=T+(m<<14&4294967295|m>>>18),m=g+(T^p&(y^T))+_[4]+3889429448&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^T&(g^y))+_[9]+568446438&4294967295,p=g+(m<<5&4294967295|m>>>27),m=T+(g^y&(p^g))+_[14]+3275163606&4294967295,T=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(T^p))+_[3]+4107603335&4294967295,y=T+(m<<14&4294967295|m>>>18),m=g+(T^p&(y^T))+_[8]+1163531501&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^T&(g^y))+_[13]+2850285829&4294967295,p=g+(m<<5&4294967295|m>>>27),m=T+(g^y&(p^g))+_[2]+4243563512&4294967295,T=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(T^p))+_[7]+1735328473&4294967295,y=T+(m<<14&4294967295|m>>>18),m=g+(T^p&(y^T))+_[12]+2368359562&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(g^y^T)+_[5]+4294588738&4294967295,p=g+(m<<4&4294967295|m>>>28),m=T+(p^g^y)+_[8]+2272392833&4294967295,T=p+(m<<11&4294967295|m>>>21),m=y+(T^p^g)+_[11]+1839030562&4294967295,y=T+(m<<16&4294967295|m>>>16),m=g+(y^T^p)+_[14]+4259657740&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^T)+_[1]+2763975236&4294967295,p=g+(m<<4&4294967295|m>>>28),m=T+(p^g^y)+_[4]+1272893353&4294967295,T=p+(m<<11&4294967295|m>>>21),m=y+(T^p^g)+_[7]+4139469664&4294967295,y=T+(m<<16&4294967295|m>>>16),m=g+(y^T^p)+_[10]+3200236656&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^T)+_[13]+681279174&4294967295,p=g+(m<<4&4294967295|m>>>28),m=T+(p^g^y)+_[0]+3936430074&4294967295,T=p+(m<<11&4294967295|m>>>21),m=y+(T^p^g)+_[3]+3572445317&4294967295,y=T+(m<<16&4294967295|m>>>16),m=g+(y^T^p)+_[6]+76029189&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^T)+_[9]+3654602809&4294967295,p=g+(m<<4&4294967295|m>>>28),m=T+(p^g^y)+_[12]+3873151461&4294967295,T=p+(m<<11&4294967295|m>>>21),m=y+(T^p^g)+_[15]+530742520&4294967295,y=T+(m<<16&4294967295|m>>>16),m=g+(y^T^p)+_[2]+3299628645&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(y^(g|~T))+_[0]+4096336452&4294967295,p=g+(m<<6&4294967295|m>>>26),m=T+(g^(p|~y))+_[7]+1126891415&4294967295,T=p+(m<<10&4294967295|m>>>22),m=y+(p^(T|~g))+_[14]+2878612391&4294967295,y=T+(m<<15&4294967295|m>>>17),m=g+(T^(y|~p))+_[5]+4237533241&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~T))+_[12]+1700485571&4294967295,p=g+(m<<6&4294967295|m>>>26),m=T+(g^(p|~y))+_[3]+2399980690&4294967295,T=p+(m<<10&4294967295|m>>>22),m=y+(p^(T|~g))+_[10]+4293915773&4294967295,y=T+(m<<15&4294967295|m>>>17),m=g+(T^(y|~p))+_[1]+2240044497&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~T))+_[8]+1873313359&4294967295,p=g+(m<<6&4294967295|m>>>26),m=T+(g^(p|~y))+_[15]+4264355552&4294967295,T=p+(m<<10&4294967295|m>>>22),m=y+(p^(T|~g))+_[6]+2734768916&4294967295,y=T+(m<<15&4294967295|m>>>17),m=g+(T^(y|~p))+_[13]+1309151649&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~T))+_[4]+4149444226&4294967295,p=g+(m<<6&4294967295|m>>>26),m=T+(g^(p|~y))+_[11]+3174756917&4294967295,T=p+(m<<10&4294967295|m>>>22),m=y+(p^(T|~g))+_[2]+718787259&4294967295,y=T+(m<<15&4294967295|m>>>17),m=g+(T^(y|~p))+_[9]+3951481745&4294967295,I.g[0]=I.g[0]+p&4294967295,I.g[1]=I.g[1]+(y+(m<<21&4294967295|m>>>11))&4294967295,I.g[2]=I.g[2]+y&4294967295,I.g[3]=I.g[3]+T&4294967295}r.prototype.u=function(I,p){p===void 0&&(p=I.length);for(var g=p-this.blockSize,_=this.B,y=this.h,T=0;T<p;){if(y==0)for(;T<=g;)s(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<p;)if(_[y++]=I.charCodeAt(T++),y==this.blockSize){s(this,_),y=0;break}}else for(;T<p;)if(_[y++]=I[T++],y==this.blockSize){s(this,_),y=0;break}}this.h=y,this.o+=p},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var p=1;p<I.length-8;++p)I[p]=0;var g=8*this.o;for(p=I.length-8;p<I.length;++p)I[p]=g&255,g/=256;for(this.u(I),I=Array(16),p=g=0;4>p;++p)for(var _=0;32>_;_+=8)I[g++]=this.g[p]>>>_&255;return I};function o(I,p){var g=l;return Object.prototype.hasOwnProperty.call(g,I)?g[I]:g[I]=p(I)}function c(I,p){this.h=p;for(var g=[],_=!0,y=I.length-1;0<=y;y--){var T=I[y]|0;_&&T==p||(g[y]=T,_=!1)}this.g=g}var l={};function h(I){return-128<=I&&128>I?o(I,function(p){return new c([p|0],0>p?-1:0)}):new c([I|0],0>I?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return w;if(0>I)return O(f(-I));for(var p=[],g=1,_=0;I>=g;_++)p[_]=I/g|0,g*=4294967296;return new c(p,0)}function v(I,p){if(I.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(I.charAt(0)=="-")return O(v(I.substring(1),p));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var g=f(Math.pow(p,8)),_=w,y=0;y<I.length;y+=8){var T=Math.min(8,I.length-y),m=parseInt(I.substring(y,y+T),p);8>T?(T=f(Math.pow(p,T)),_=_.j(T).add(f(m))):(_=_.j(g),_=_.add(f(m)))}return _}var w=h(0),b=h(1),C=h(16777216);n=c.prototype,n.m=function(){if(V(this))return-O(this).m();for(var I=0,p=1,g=0;g<this.g.length;g++){var _=this.i(g);I+=(0<=_?_:4294967296+_)*p,p*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(k(this))return"0";if(V(this))return"-"+O(this).toString(I);for(var p=f(Math.pow(I,6)),g=this,_="";;){var y=Y(g,p).g;g=z(g,y.j(p));var T=((0<g.g.length?g.g[0]:g.h)>>>0).toString(I);if(g=y,k(g))return T+_;for(;6>T.length;)T="0"+T;_=T+_}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function k(I){if(I.h!=0)return!1;for(var p=0;p<I.g.length;p++)if(I.g[p]!=0)return!1;return!0}function V(I){return I.h==-1}n.l=function(I){return I=z(this,I),V(I)?-1:k(I)?0:1};function O(I){for(var p=I.g.length,g=[],_=0;_<p;_++)g[_]=~I.g[_];return new c(g,~I.h).add(b)}n.abs=function(){return V(this)?O(this):this},n.add=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0,y=0;y<=p;y++){var T=_+(this.i(y)&65535)+(I.i(y)&65535),m=(T>>>16)+(this.i(y)>>>16)+(I.i(y)>>>16);_=m>>>16,T&=65535,m&=65535,g[y]=m<<16|T}return new c(g,g[g.length-1]&-2147483648?-1:0)};function z(I,p){return I.add(O(p))}n.j=function(I){if(k(this)||k(I))return w;if(V(this))return V(I)?O(this).j(O(I)):O(O(this).j(I));if(V(I))return O(this.j(O(I)));if(0>this.l(C)&&0>I.l(C))return f(this.m()*I.m());for(var p=this.g.length+I.g.length,g=[],_=0;_<2*p;_++)g[_]=0;for(_=0;_<this.g.length;_++)for(var y=0;y<I.g.length;y++){var T=this.i(_)>>>16,m=this.i(_)&65535,Ue=I.i(y)>>>16,vn=I.i(y)&65535;g[2*_+2*y]+=m*vn,F(g,2*_+2*y),g[2*_+2*y+1]+=T*vn,F(g,2*_+2*y+1),g[2*_+2*y+1]+=m*Ue,F(g,2*_+2*y+1),g[2*_+2*y+2]+=T*Ue,F(g,2*_+2*y+2)}for(_=0;_<p;_++)g[_]=g[2*_+1]<<16|g[2*_];for(_=p;_<2*p;_++)g[_]=0;return new c(g,0)};function F(I,p){for(;(I[p]&65535)!=I[p];)I[p+1]+=I[p]>>>16,I[p]&=65535,p++}function j(I,p){this.g=I,this.h=p}function Y(I,p){if(k(p))throw Error("division by zero");if(k(I))return new j(w,w);if(V(I))return p=Y(O(I),p),new j(O(p.g),O(p.h));if(V(p))return p=Y(I,O(p)),new j(O(p.g),p.h);if(30<I.g.length){if(V(I)||V(p))throw Error("slowDivide_ only works with positive integers.");for(var g=b,_=p;0>=_.l(I);)g=De(g),_=De(_);var y=se(g,1),T=se(_,1);for(_=se(_,2),g=se(g,2);!k(_);){var m=T.add(_);0>=m.l(I)&&(y=y.add(g),T=m),_=se(_,1),g=se(g,1)}return p=z(I,y.j(p)),new j(y,p)}for(y=w;0<=I.l(p);){for(g=Math.max(1,Math.floor(I.m()/p.m())),_=Math.ceil(Math.log(g)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),T=f(g),m=T.j(p);V(m)||0<m.l(I);)g-=_,T=f(g),m=T.j(p);k(T)&&(T=b),y=y.add(T),I=z(I,m)}return new j(y,I)}n.A=function(I){return Y(this,I).h},n.and=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0;_<p;_++)g[_]=this.i(_)&I.i(_);return new c(g,this.h&I.h)},n.or=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0;_<p;_++)g[_]=this.i(_)|I.i(_);return new c(g,this.h|I.h)},n.xor=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0;_<p;_++)g[_]=this.i(_)^I.i(_);return new c(g,this.h^I.h)};function De(I){for(var p=I.g.length+1,g=[],_=0;_<p;_++)g[_]=I.i(_)<<1|I.i(_-1)>>>31;return new c(g,I.h)}function se(I,p){var g=p>>5;p%=32;for(var _=I.g.length-g,y=[],T=0;T<_;T++)y[T]=0<p?I.i(T+g)>>>p|I.i(T+g+1)<<32-p:I.i(T+g);return new c(y,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,vl=yl.Md5=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=f,c.fromString=v,ai=yl.Integer=c}).apply(typeof _l<"u"?_l:typeof self<"u"?self:typeof window<"u"?window:{});var ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ze={};var co,Sg,Qt,uo,Jn,ui,lo,ho,fo;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(i,a,u){return i==Array.prototype||i==Object.prototype||(i[a]=u.value),i};function t(i){i=[typeof globalThis=="object"&&globalThis,i,typeof window=="object"&&window,typeof self=="object"&&self,typeof ci=="object"&&ci];for(var a=0;a<i.length;++a){var u=i[a];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function s(i,a){if(a)e:{var u=r;i=i.split(".");for(var d=0;d<i.length-1;d++){var E=i[d];if(!(E in u))break e;u=u[E]}i=i[i.length-1],d=u[i],a=a(d),a!=d&&a!=null&&e(u,i,{configurable:!0,writable:!0,value:a})}}function o(i,a){i instanceof String&&(i+="");var u=0,d=!1,E={next:function(){if(!d&&u<i.length){var A=u++;return{value:a(A,i[A]),done:!1}}return d=!0,{done:!0,value:void 0}}};return E[Symbol.iterator]=function(){return E},E}s("Array.prototype.values",function(i){return i||function(){return o(this,function(a,u){return u})}});var c=c||{},l=this||self;function h(i){var a=typeof i;return a=a!="object"?a:i?Array.isArray(i)?"array":a:"null",a=="array"||a=="object"&&typeof i.length=="number"}function f(i){var a=typeof i;return a=="object"&&i!=null||a=="function"}function v(i,a,u){return i.call.apply(i.bind,arguments)}function w(i,a,u){if(!i)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var E=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(E,d),i.apply(a,E)}}return function(){return i.apply(a,arguments)}}function b(i,a,u){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:w,b.apply(null,arguments)}function C(i,a){var u=Array.prototype.slice.call(arguments,1);return function(){var d=u.slice();return d.push.apply(d,arguments),i.apply(this,d)}}function k(i,a){function u(){}u.prototype=a.prototype,i.aa=a.prototype,i.prototype=new u,i.prototype.constructor=i,i.Qb=function(d,E,A){for(var P=Array(arguments.length-2),W=2;W<arguments.length;W++)P[W-2]=arguments[W];return a.prototype[E].apply(d,P)}}function V(i){let a=i.length;if(0<a){let u=Array(a);for(let d=0;d<a;d++)u[d]=i[d];return u}return[]}function O(i,a){for(let u=1;u<arguments.length;u++){let d=arguments[u];if(h(d)){let E=i.length||0,A=d.length||0;i.length=E+A;for(let P=0;P<A;P++)i[E+P]=d[P]}else i.push(d)}}class z{constructor(a,u){this.i=a,this.j=u,this.h=0,this.g=null}get(){let a;return 0<this.h?(this.h--,a=this.g,this.g=a.next,a.next=null):a=this.i(),a}}function F(i){return/^[\s\xa0]*$/.test(i)}function j(){var i=l.navigator;return i&&(i=i.userAgent)?i:""}function Y(i){return Y[" "](i),i}Y[" "]=function(){};var De=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function se(i,a,u){for(let d in i)a.call(u,i[d],d,i)}function I(i,a){for(let u in i)a.call(void 0,i[u],u,i)}function p(i){let a={};for(let u in i)a[u]=i[u];return a}let g="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(i,a){let u,d;for(let E=1;E<arguments.length;E++){d=arguments[E];for(u in d)i[u]=d[u];for(let A=0;A<g.length;A++)u=g[A],Object.prototype.hasOwnProperty.call(d,u)&&(i[u]=d[u])}}function y(i){var a=1;i=i.split(":");let u=[];for(;0<a&&i.length;)u.push(i.shift()),a--;return i.length&&u.push(i.join(":")),u}function T(i){l.setTimeout(()=>{throw i},0)}function m(){var i=qi;let a=null;return i.g&&(a=i.g,i.g=i.g.next,i.g||(i.h=null),a.next=null),a}class Ue{constructor(){this.h=this.g=null}add(a,u){let d=vn.get();d.set(a,u),this.h?this.h.next=d:this.g=d,this.h=d}}var vn=new z(()=>new Id,i=>i.reset());class Id{constructor(){this.next=this.g=this.h=null}set(a,u){this.h=a,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let In,En=!1,qi=new Ue,nc=()=>{let i=l.Promise.resolve(void 0);In=()=>{i.then(Ed)}};var Ed=()=>{for(var i;i=m();){try{i.h.call(i.g)}catch(u){T(u)}var a=vn;a.j(i),100>a.h&&(a.h++,i.next=a.g,a.g=i)}En=!1};function Qe(){this.s=this.s,this.C=this.C}Qe.prototype.s=!1,Qe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Qe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(i,a){this.type=i,this.g=this.target=a,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var wd=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var i=!1,a=Object.defineProperty({},"passive",{get:function(){i=!0}});try{let u=()=>{};l.addEventListener("test",u,a),l.removeEventListener("test",u,a)}catch{}return i})();function wn(i,a){if(ue.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var u=this.type=i.type,d=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=a,a=i.relatedTarget){if(De){e:{try{Y(a.nodeName);var E=!0;break e}catch{}E=!1}E||(a=null)}}else u=="mouseover"?a=i.fromElement:u=="mouseout"&&(a=i.toElement);this.relatedTarget=a,d?(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:Td[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&wn.aa.h.call(this)}}k(wn,ue);var Td={2:"touch",3:"pen",4:"mouse"};wn.prototype.h=function(){wn.aa.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var Tn="closure_listenable_"+(1e6*Math.random()|0),Ad=0;function bd(i,a,u,d,E){this.listener=i,this.proxy=null,this.src=a,this.type=u,this.capture=!!d,this.ha=E,this.key=++Ad,this.da=this.fa=!1}function _r(i){i.da=!0,i.listener=null,i.proxy=null,i.src=null,i.ha=null}function yr(i){this.src=i,this.g={},this.h=0}yr.prototype.add=function(i,a,u,d,E){var A=i.toString();i=this.g[A],i||(i=this.g[A]=[],this.h++);var P=ji(i,a,d,E);return-1<P?(a=i[P],u||(a.fa=!1)):(a=new bd(a,this.src,A,!!d,E),a.fa=u,i.push(a)),a};function $i(i,a){var u=a.type;if(u in i.g){var d=i.g[u],E=Array.prototype.indexOf.call(d,a,void 0),A;(A=0<=E)&&Array.prototype.splice.call(d,E,1),A&&(_r(a),i.g[u].length==0&&(delete i.g[u],i.h--))}}function ji(i,a,u,d){for(var E=0;E<i.length;++E){var A=i[E];if(!A.da&&A.listener==a&&A.capture==!!u&&A.ha==d)return E}return-1}var zi="closure_lm_"+(1e6*Math.random()|0),Wi={};function rc(i,a,u,d,E){if(d&&d.once)return sc(i,a,u,d,E);if(Array.isArray(a)){for(var A=0;A<a.length;A++)rc(i,a[A],u,d,E);return null}return u=Qi(u),i&&i[Tn]?i.K(a,u,f(d)?!!d.capture:!!d,E):ic(i,a,u,!1,d,E)}function ic(i,a,u,d,E,A){if(!a)throw Error("Invalid event type");var P=f(E)?!!E.capture:!!E,W=Ki(i);if(W||(i[zi]=W=new yr(i)),u=W.add(a,u,d,P,A),u.proxy)return u;if(d=Sd(),u.proxy=d,d.src=i,d.listener=u,i.addEventListener)wd||(E=P),E===void 0&&(E=!1),i.addEventListener(a.toString(),d,E);else if(i.attachEvent)i.attachEvent(ac(a.toString()),d);else if(i.addListener&&i.removeListener)i.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Sd(){function i(u){return a.call(i.src,i.listener,u)}let a=Rd;return i}function sc(i,a,u,d,E){if(Array.isArray(a)){for(var A=0;A<a.length;A++)sc(i,a[A],u,d,E);return null}return u=Qi(u),i&&i[Tn]?i.L(a,u,f(d)?!!d.capture:!!d,E):ic(i,a,u,!0,d,E)}function oc(i,a,u,d,E){if(Array.isArray(a))for(var A=0;A<a.length;A++)oc(i,a[A],u,d,E);else d=f(d)?!!d.capture:!!d,u=Qi(u),i&&i[Tn]?(i=i.i,a=String(a).toString(),a in i.g&&(A=i.g[a],u=ji(A,u,d,E),-1<u&&(_r(A[u]),Array.prototype.splice.call(A,u,1),A.length==0&&(delete i.g[a],i.h--)))):i&&(i=Ki(i))&&(a=i.g[a.toString()],i=-1,a&&(i=ji(a,u,d,E)),(u=-1<i?a[i]:null)&&Gi(u))}function Gi(i){if(typeof i!="number"&&i&&!i.da){var a=i.src;if(a&&a[Tn])$i(a.i,i);else{var u=i.type,d=i.proxy;a.removeEventListener?a.removeEventListener(u,d,i.capture):a.detachEvent?a.detachEvent(ac(u),d):a.addListener&&a.removeListener&&a.removeListener(d),(u=Ki(a))?($i(u,i),u.h==0&&(u.src=null,a[zi]=null)):_r(i)}}}function ac(i){return i in Wi?Wi[i]:Wi[i]="on"+i}function Rd(i,a){if(i.da)i=!0;else{a=new wn(a,this);var u=i.listener,d=i.ha||i.src;i.fa&&Gi(i),i=u.call(d,a)}return i}function Ki(i){return i=i[zi],i instanceof yr?i:null}var Hi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qi(i){return typeof i=="function"?i:(i[Hi]||(i[Hi]=function(a){return i.handleEvent(a)}),i[Hi])}function le(){Qe.call(this),this.i=new yr(this),this.M=this,this.F=null}k(le,Qe),le.prototype[Tn]=!0,le.prototype.removeEventListener=function(i,a,u,d){oc(this,i,a,u,d)};function ge(i,a){var u,d=i.F;if(d)for(u=[];d;d=d.F)u.push(d);if(i=i.M,d=a.type||a,typeof a=="string")a=new ue(a,i);else if(a instanceof ue)a.target=a.target||i;else{var E=a;a=new ue(d,i),_(a,E)}if(E=!0,u)for(var A=u.length-1;0<=A;A--){var P=a.g=u[A];E=vr(P,d,!0,a)&&E}if(P=a.g=i,E=vr(P,d,!0,a)&&E,E=vr(P,d,!1,a)&&E,u)for(A=0;A<u.length;A++)P=a.g=u[A],E=vr(P,d,!1,a)&&E}le.prototype.N=function(){if(le.aa.N.call(this),this.i){var i=this.i,a;for(a in i.g){for(var u=i.g[a],d=0;d<u.length;d++)_r(u[d]);delete i.g[a],i.h--}}this.F=null},le.prototype.K=function(i,a,u,d){return this.i.add(String(i),a,!1,u,d)},le.prototype.L=function(i,a,u,d){return this.i.add(String(i),a,!0,u,d)};function vr(i,a,u,d){if(a=i.i.g[String(a)],!a)return!0;a=a.concat();for(var E=!0,A=0;A<a.length;++A){var P=a[A];if(P&&!P.da&&P.capture==u){var W=P.listener,ce=P.ha||P.src;P.fa&&$i(i.i,P),E=W.call(ce,d)!==!1&&E}}return E&&!d.defaultPrevented}function cc(i,a,u){if(typeof i=="function")u&&(i=b(i,u));else if(i&&typeof i.handleEvent=="function")i=b(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:l.setTimeout(i,a||0)}function uc(i){i.g=cc(()=>{i.g=null,i.i&&(i.i=!1,uc(i))},i.l);let a=i.h;i.h=null,i.m.apply(null,a)}class Pd extends Qe{constructor(a,u){super(),this.m=a,this.l=u,this.h=null,this.i=!1,this.g=null}j(a){this.h=arguments,this.g?this.i=!0:uc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function An(i){Qe.call(this),this.h=i,this.g={}}k(An,Qe);var lc=[];function hc(i){se(i.g,function(a,u){this.g.hasOwnProperty(u)&&Gi(a)},i),i.g={}}An.prototype.N=function(){An.aa.N.call(this),hc(this)},An.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ji=l.JSON.stringify,Cd=l.JSON.parse,kd=class{stringify(i){return l.JSON.stringify(i,void 0)}parse(i){return l.JSON.parse(i,void 0)}};function Yi(){}Yi.prototype.h=null;function dc(i){return i.h||(i.h=i.i())}function fc(){}var bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xi(){ue.call(this,"d")}k(Xi,ue);function Zi(){ue.call(this,"c")}k(Zi,ue);var lt={},pc=null;function Ir(){return pc=pc||new le}lt.La="serverreachability";function mc(i){ue.call(this,lt.La,i)}k(mc,ue);function Sn(i){let a=Ir();ge(a,new mc(a))}lt.STAT_EVENT="statevent";function gc(i,a){ue.call(this,lt.STAT_EVENT,i),this.stat=a}k(gc,ue);function _e(i){let a=Ir();ge(a,new gc(a,i))}lt.Ma="timingevent";function _c(i,a){ue.call(this,lt.Ma,i),this.size=a}k(_c,ue);function Rn(i,a){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){i()},a)}function Pn(){this.g=!0}Pn.prototype.xa=function(){this.g=!1};function Dd(i,a,u,d,E,A){i.info(function(){if(i.g)if(A)for(var P="",W=A.split("&"),ce=0;ce<W.length;ce++){var q=W[ce].split("=");if(1<q.length){var he=q[0];q=q[1];var de=he.split("_");P=2<=de.length&&de[1]=="type"?P+(he+"="+q+"&"):P+(he+"=redacted&")}}else P=null;else P=A;return"XMLHTTP REQ ("+d+") [attempt "+E+"]: "+a+`
`+u+`
`+P})}function Nd(i,a,u,d,E,A,P){i.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+E+"]: "+a+`
`+u+`
`+A+" "+P})}function Ut(i,a,u,d){i.info(function(){return"XMLHTTP TEXT ("+a+"): "+Vd(i,u)+(d?" "+d:"")})}function Od(i,a){i.info(function(){return"TIMEOUT: "+a})}Pn.prototype.info=function(){};function Vd(i,a){if(!i.g)return a;if(!a)return null;try{var u=JSON.parse(a);if(u){for(i=0;i<u.length;i++)if(Array.isArray(u[i])){var d=u[i];if(!(2>d.length)){var E=d[1];if(Array.isArray(E)&&!(1>E.length)){var A=E[0];if(A!="noop"&&A!="stop"&&A!="close")for(var P=1;P<E.length;P++)E[P]=""}}}}return Ji(u)}catch{return a}}var Er={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},es;function wr(){}k(wr,Yi),wr.prototype.g=function(){return new XMLHttpRequest},wr.prototype.i=function(){return{}},es=new wr;function Je(i,a,u,d){this.j=i,this.i=a,this.l=u,this.R=d||1,this.U=new An(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new vc}function vc(){this.i=null,this.g="",this.h=!1}var Ic={},ts={};function ns(i,a,u){i.L=1,i.v=Sr(Be(a)),i.m=u,i.P=!0,Ec(i,null)}function Ec(i,a){i.F=Date.now(),Tr(i),i.A=Be(i.v);var u=i.A,d=i.R;Array.isArray(d)||(d=[String(d)]),xc(u.i,"t",d),i.C=0,u=i.j.J,i.h=new vc,i.g=Zc(i.j,u?a:null,!i.m),0<i.O&&(i.M=new Pd(b(i.Y,i,i.g),i.O)),a=i.U,u=i.g,d=i.ca;var E="readystatechange";Array.isArray(E)||(E&&(lc[0]=E.toString()),E=lc);for(var A=0;A<E.length;A++){var P=rc(u,E[A],d||a.handleEvent,!1,a.h||a);if(!P)break;a.g[P.key]=P}a=i.H?p(i.H):{},i.m?(i.u||(i.u="POST"),a["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.A,i.u,i.m,a)):(i.u="GET",i.g.ea(i.A,i.u,null,a)),Sn(),Dd(i.i,i.u,i.A,i.l,i.R,i.m)}Je.prototype.ca=function(i){i=i.target;let a=this.M;a&&qe(i)==3?a.j():this.Y(i)},Je.prototype.Y=function(i){try{if(i==this.g)e:{let de=qe(this.g);var a=this.g.Ba();let $t=this.g.Z();if(!(3>de)&&(de!=3||this.g&&(this.h.h||this.g.oa()||$c(this.g)))){this.J||de!=4||a==7||(a==8||0>=$t?Sn(3):Sn(2)),rs(this);var u=this.g.Z();this.X=u;t:if(wc(this)){var d=$c(this.g);i="";var E=d.length,A=qe(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ht(this),Cn(this);var P="";break t}this.h.i=new l.TextDecoder}for(a=0;a<E;a++)this.h.h=!0,i+=this.h.i.decode(d[a],{stream:!(A&&a==E-1)});d.length=0,this.h.g+=i,this.C=0,P=this.h.g}else P=this.g.oa();if(this.o=u==200,Nd(this.i,this.u,this.A,this.l,this.R,de,u),this.o){if(this.T&&!this.K){t:{if(this.g){var W,ce=this.g;if((W=ce.g?ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(W)){var q=W;break t}}q=null}if(u=q)Ut(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,is(this,u);else{this.o=!1,this.s=3,_e(12),ht(this),Cn(this);break e}}if(this.P){u=!0;let Re;for(;!this.J&&this.C<P.length;)if(Re=xd(this,P),Re==ts){de==4&&(this.s=4,_e(14),u=!1),Ut(this.i,this.l,null,"[Incomplete Response]");break}else if(Re==Ic){this.s=4,_e(15),Ut(this.i,this.l,P,"[Invalid Chunk]"),u=!1;break}else Ut(this.i,this.l,Re,null),is(this,Re);if(wc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),de!=4||P.length!=0||this.h.h||(this.s=1,_e(16),u=!1),this.o=this.o&&u,!u)Ut(this.i,this.l,P,"[Invalid Chunked Response]"),ht(this),Cn(this);else if(0<P.length&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.ba&&!he.M&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+P.length),ls(he),he.M=!0,_e(11))}}else Ut(this.i,this.l,P,null),is(this,P);de==4&&ht(this),this.o&&!this.J&&(de==4?Qc(this.j,this):(this.o=!1,Tr(this)))}else Xd(this.g),u==400&&0<P.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),ht(this),Cn(this)}}}catch{}finally{}};function wc(i){return i.g?i.u=="GET"&&i.L!=2&&i.j.Ca:!1}function xd(i,a){var u=i.C,d=a.indexOf(`
`,u);return d==-1?ts:(u=Number(a.substring(u,d)),isNaN(u)?Ic:(d+=1,d+u>a.length?ts:(a=a.slice(d,d+u),i.C=d+u,a)))}Je.prototype.cancel=function(){this.J=!0,ht(this)};function Tr(i){i.S=Date.now()+i.I,Tc(i,i.I)}function Tc(i,a){if(i.B!=null)throw Error("WatchDog timer not null");i.B=Rn(b(i.ba,i),a)}function rs(i){i.B&&(l.clearTimeout(i.B),i.B=null)}Je.prototype.ba=function(){this.B=null;let i=Date.now();0<=i-this.S?(Od(this.i,this.A),this.L!=2&&(Sn(),_e(17)),ht(this),this.s=2,Cn(this)):Tc(this,this.S-i)};function Cn(i){i.j.G==0||i.J||Qc(i.j,i)}function ht(i){rs(i);var a=i.M;a&&typeof a.ma=="function"&&a.ma(),i.M=null,hc(i.U),i.g&&(a=i.g,i.g=null,a.abort(),a.ma())}function is(i,a){try{var u=i.j;if(u.G!=0&&(u.g==i||ss(u.h,i))){if(!i.K&&ss(u.h,i)&&u.G==3){try{var d=u.Da.g.parse(a)}catch{d=null}if(Array.isArray(d)&&d.length==3){var E=d;if(E[0]==0){e:if(!u.u){if(u.g)if(u.g.F+3e3<i.F)Dr(u),Cr(u);else break e;us(u),_e(18)}}else u.za=E[1],0<u.za-u.T&&37500>E[2]&&u.F&&u.v==0&&!u.C&&(u.C=Rn(b(u.Za,u),6e3));if(1>=Sc(u.h)&&u.ca){try{u.ca()}catch{}u.ca=void 0}}else ft(u,11)}else if((i.K||u.g==i)&&Dr(u),!F(a))for(E=u.Da.g.parse(a),a=0;a<E.length;a++){let q=E[a];if(u.T=q[0],q=q[1],u.G==2)if(q[0]=="c"){u.K=q[1],u.ia=q[2];let he=q[3];he!=null&&(u.la=he,u.j.info("VER="+u.la));let de=q[4];de!=null&&(u.Aa=de,u.j.info("SVER="+u.Aa));let $t=q[5];$t!=null&&typeof $t=="number"&&0<$t&&(d=1.5*$t,u.L=d,u.j.info("backChannelRequestTimeoutMs_="+d)),d=u;let Re=i.g;if(Re){let Or=Re.g?Re.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Or){var A=d.h;A.g||Or.indexOf("spdy")==-1&&Or.indexOf("quic")==-1&&Or.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(os(A,A.h),A.h=null))}if(d.D){let hs=Re.g?Re.g.getResponseHeader("X-HTTP-Session-Id"):null;hs&&(d.ya=hs,K(d.I,d.D,hs))}}u.G=3,u.l&&u.l.ua(),u.ba&&(u.R=Date.now()-i.F,u.j.info("Handshake RTT: "+u.R+"ms")),d=u;var P=i;if(d.qa=Xc(d,d.J?d.ia:null,d.W),P.K){Rc(d.h,P);var W=P,ce=d.L;ce&&(W.I=ce),W.B&&(rs(W),Tr(W)),d.g=P}else Kc(d);0<u.i.length&&kr(u)}else q[0]!="stop"&&q[0]!="close"||ft(u,7);else u.G==3&&(q[0]=="stop"||q[0]=="close"?q[0]=="stop"?ft(u,7):cs(u):q[0]!="noop"&&u.l&&u.l.ta(q),u.v=0)}}Sn(4)}catch{}}var Ld=class{constructor(i,a){this.g=i,this.map=a}};function Ac(i){this.l=i||10,l.PerformanceNavigationTiming?(i=l.performance.getEntriesByType("navigation"),i=0<i.length&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bc(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function Sc(i){return i.h?1:i.g?i.g.size:0}function ss(i,a){return i.h?i.h==a:i.g?i.g.has(a):!1}function os(i,a){i.g?i.g.add(a):i.h=a}function Rc(i,a){i.h&&i.h==a?i.h=null:i.g&&i.g.has(a)&&i.g.delete(a)}Ac.prototype.cancel=function(){if(this.i=Pc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let i of this.g.values())i.cancel();this.g.clear()}};function Pc(i){if(i.h!=null)return i.i.concat(i.h.D);if(i.g!=null&&i.g.size!==0){let a=i.i;for(let u of i.g.values())a=a.concat(u.D);return a}return V(i.i)}function Md(i){if(i.V&&typeof i.V=="function")return i.V();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if(typeof i=="string")return i.split("");if(h(i)){for(var a=[],u=i.length,d=0;d<u;d++)a.push(i[d]);return a}a=[],u=0;for(d in i)a[u++]=i[d];return a}function Fd(i){if(i.na&&typeof i.na=="function")return i.na();if(!i.V||typeof i.V!="function"){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(h(i)||typeof i=="string"){var a=[];i=i.length;for(var u=0;u<i;u++)a.push(u);return a}a=[],u=0;for(let d in i)a[u++]=d;return a}}}function Cc(i,a){if(i.forEach&&typeof i.forEach=="function")i.forEach(a,void 0);else if(h(i)||typeof i=="string")Array.prototype.forEach.call(i,a,void 0);else for(var u=Fd(i),d=Md(i),E=d.length,A=0;A<E;A++)a.call(void 0,d[A],u&&u[A],i)}var kc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ud(i,a){if(i){i=i.split("&");for(var u=0;u<i.length;u++){var d=i[u].indexOf("="),E=null;if(0<=d){var A=i[u].substring(0,d);E=i[u].substring(d+1)}else A=i[u];a(A,E?decodeURIComponent(E.replace(/\+/g," ")):"")}}}function dt(i){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,i instanceof dt){this.h=i.h,Ar(this,i.j),this.o=i.o,this.g=i.g,br(this,i.s),this.l=i.l;var a=i.i,u=new Nn;u.i=a.i,a.g&&(u.g=new Map(a.g),u.h=a.h),Dc(this,u),this.m=i.m}else i&&(a=String(i).match(kc))?(this.h=!1,Ar(this,a[1]||"",!0),this.o=kn(a[2]||""),this.g=kn(a[3]||"",!0),br(this,a[4]),this.l=kn(a[5]||"",!0),Dc(this,a[6]||"",!0),this.m=kn(a[7]||"")):(this.h=!1,this.i=new Nn(null,this.h))}dt.prototype.toString=function(){var i=[],a=this.j;a&&i.push(Dn(a,Nc,!0),":");var u=this.g;return(u||a=="file")&&(i.push("//"),(a=this.o)&&i.push(Dn(a,Nc,!0),"@"),i.push(encodeURIComponent(String(u)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.s,u!=null&&i.push(":",String(u))),(u=this.l)&&(this.g&&u.charAt(0)!="/"&&i.push("/"),i.push(Dn(u,u.charAt(0)=="/"?$d:qd,!0))),(u=this.i.toString())&&i.push("?",u),(u=this.m)&&i.push("#",Dn(u,zd)),i.join("")};function Be(i){return new dt(i)}function Ar(i,a,u){i.j=u?kn(a,!0):a,i.j&&(i.j=i.j.replace(/:$/,""))}function br(i,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);i.s=a}else i.s=null}function Dc(i,a,u){a instanceof Nn?(i.i=a,Wd(i.i,i.h)):(u||(a=Dn(a,jd)),i.i=new Nn(a,i.h))}function K(i,a,u){i.i.set(a,u)}function Sr(i){return K(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function kn(i,a){return i?a?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Dn(i,a,u){return typeof i=="string"?(i=encodeURI(i).replace(a,Bd),u&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function Bd(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var Nc=/[#\/\?@]/g,qd=/[#\?:]/g,$d=/[#\?]/g,jd=/[#\?@]/g,zd=/#/g;function Nn(i,a){this.h=this.g=null,this.i=i||null,this.j=!!a}function Ye(i){i.g||(i.g=new Map,i.h=0,i.i&&Ud(i.i,function(a,u){i.add(decodeURIComponent(a.replace(/\+/g," ")),u)}))}n=Nn.prototype,n.add=function(i,a){Ye(this),this.i=null,i=Bt(this,i);var u=this.g.get(i);return u||this.g.set(i,u=[]),u.push(a),this.h+=1,this};function Oc(i,a){Ye(i),a=Bt(i,a),i.g.has(a)&&(i.i=null,i.h-=i.g.get(a).length,i.g.delete(a))}function Vc(i,a){return Ye(i),a=Bt(i,a),i.g.has(a)}n.forEach=function(i,a){Ye(this),this.g.forEach(function(u,d){u.forEach(function(E){i.call(a,E,d,this)},this)},this)},n.na=function(){Ye(this);let i=Array.from(this.g.values()),a=Array.from(this.g.keys()),u=[];for(let d=0;d<a.length;d++){let E=i[d];for(let A=0;A<E.length;A++)u.push(a[d])}return u},n.V=function(i){Ye(this);let a=[];if(typeof i=="string")Vc(this,i)&&(a=a.concat(this.g.get(Bt(this,i))));else{i=Array.from(this.g.values());for(let u=0;u<i.length;u++)a=a.concat(i[u])}return a},n.set=function(i,a){return Ye(this),this.i=null,i=Bt(this,i),Vc(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[a]),this.h+=1,this},n.get=function(i,a){return i?(i=this.V(i),0<i.length?String(i[0]):a):a};function xc(i,a,u){Oc(i,a),0<u.length&&(i.i=null,i.g.set(Bt(i,a),V(u)),i.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let i=[],a=Array.from(this.g.keys());for(var u=0;u<a.length;u++){var d=a[u];let A=encodeURIComponent(String(d)),P=this.V(d);for(d=0;d<P.length;d++){var E=A;P[d]!==""&&(E+="="+encodeURIComponent(String(P[d]))),i.push(E)}}return this.i=i.join("&")};function Bt(i,a){return a=String(a),i.j&&(a=a.toLowerCase()),a}function Wd(i,a){a&&!i.j&&(Ye(i),i.i=null,i.g.forEach(function(u,d){var E=d.toLowerCase();d!=E&&(Oc(this,d),xc(this,E,u))},i)),i.j=a}function Gd(i,a){let u=new Pn;if(l.Image){let d=new Image;d.onload=C(Xe,u,"TestLoadImage: loaded",!0,a,d),d.onerror=C(Xe,u,"TestLoadImage: error",!1,a,d),d.onabort=C(Xe,u,"TestLoadImage: abort",!1,a,d),d.ontimeout=C(Xe,u,"TestLoadImage: timeout",!1,a,d),l.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=i}else a(!1)}function Kd(i,a){let u=new Pn,d=new AbortController,E=setTimeout(()=>{d.abort(),Xe(u,"TestPingServer: timeout",!1,a)},1e4);fetch(i,{signal:d.signal}).then(A=>{clearTimeout(E),A.ok?Xe(u,"TestPingServer: ok",!0,a):Xe(u,"TestPingServer: server error",!1,a)}).catch(()=>{clearTimeout(E),Xe(u,"TestPingServer: error",!1,a)})}function Xe(i,a,u,d,E){try{E&&(E.onload=null,E.onerror=null,E.onabort=null,E.ontimeout=null),d(u)}catch{}}function Hd(){this.g=new kd}function Qd(i,a,u){let d=u||"";try{Cc(i,function(E,A){let P=E;f(E)&&(P=Ji(E)),a.push(d+A+"="+encodeURIComponent(P))})}catch(E){throw a.push(d+"type="+encodeURIComponent("_badmap")),E}}function On(i){this.l=i.Ub||null,this.j=i.eb||!1}k(On,Yi),On.prototype.g=function(){return new Rr(this.l,this.j)},On.prototype.i=(function(i){return function(){return i}})({});function Rr(i,a){le.call(this),this.D=i,this.o=a,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Rr,le),n=Rr.prototype,n.open=function(i,a){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=i,this.A=a,this.readyState=1,xn(this)},n.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let a={headers:this.u,method:this.B,credentials:this.m,cache:void 0};i&&(a.body=i),(this.D||l).fetch(new Request(this.A,a)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vn(this)),this.readyState=0},n.Sa=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,xn(this)),this.g&&(this.readyState=3,xn(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lc(this)}else i.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lc(i){i.j.read().then(i.Pa.bind(i)).catch(i.ga.bind(i))}n.Pa=function(i){if(this.g){if(this.o&&i.value)this.response.push(i.value);else if(!this.o){var a=i.value?i.value:new Uint8Array(0);(a=this.v.decode(a,{stream:!i.done}))&&(this.response=this.responseText+=a)}i.done?Vn(this):xn(this),this.readyState==3&&Lc(this)}},n.Ra=function(i){this.g&&(this.response=this.responseText=i,Vn(this))},n.Qa=function(i){this.g&&(this.response=i,Vn(this))},n.ga=function(){this.g&&Vn(this)};function Vn(i){i.readyState=4,i.l=null,i.j=null,i.v=null,xn(i)}n.setRequestHeader=function(i,a){this.u.append(i,a)},n.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let i=[],a=this.h.entries();for(var u=a.next();!u.done;)u=u.value,i.push(u[0]+": "+u[1]),u=a.next();return i.join(`\r
`)};function xn(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(Rr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});function Mc(i){let a="";return se(i,function(u,d){a+=d,a+=":",a+=u,a+=`\r
`}),a}function as(i,a,u){e:{for(d in u){var d=!1;break e}d=!0}d||(u=Mc(u),typeof i=="string"?u!=null&&encodeURIComponent(String(u)):K(i,a,u))}function H(i){le.call(this),this.headers=new Map,this.o=i||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(H,le);var Jd=/^https?$/i,Yd=["POST","PUT"];n=H.prototype,n.Ha=function(i){this.J=i},n.ea=function(i,a,u,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+i);a=a?a.toUpperCase():"GET",this.D=i,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():es.g(),this.v=this.o?dc(this.o):dc(es),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(a,String(i),!0),this.B=!1}catch(A){Fc(this,A);return}if(i=u||"",u=new Map(this.headers),d)if(Object.getPrototypeOf(d)===Object.prototype)for(var E in d)u.set(E,d[E]);else if(typeof d.keys=="function"&&typeof d.get=="function")for(let A of d.keys())u.set(A,d.get(A));else throw Error("Unknown input type for opt_headers: "+String(d));d=Array.from(u.keys()).find(A=>A.toLowerCase()=="content-type"),E=l.FormData&&i instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Yd,a,void 0))||d||E||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,P]of u)this.g.setRequestHeader(A,P);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qc(this),this.u=!0,this.g.send(i),this.u=!1}catch(A){Fc(this,A)}};function Fc(i,a){i.h=!1,i.g&&(i.j=!0,i.g.abort(),i.j=!1),i.l=a,i.m=5,Uc(i),Pr(i)}function Uc(i){i.A||(i.A=!0,ge(i,"complete"),ge(i,"error"))}n.abort=function(i){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=i||7,ge(this,"complete"),ge(this,"abort"),Pr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pr(this,!0)),H.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Bc(this):this.bb())},n.bb=function(){Bc(this)};function Bc(i){if(i.h&&typeof c<"u"&&(!i.v[1]||qe(i)!=4||i.Z()!=2)){if(i.u&&qe(i)==4)cc(i.Ea,0,i);else if(ge(i,"readystatechange"),qe(i)==4){i.h=!1;try{let P=i.Z();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}var u;if(!(u=a)){var d;if(d=P===0){var E=String(i.D).match(kc)[1]||null;!E&&l.self&&l.self.location&&(E=l.self.location.protocol.slice(0,-1)),d=!Jd.test(E?E.toLowerCase():"")}u=d}if(u)ge(i,"complete"),ge(i,"success");else{i.m=6;try{var A=2<qe(i)?i.g.statusText:""}catch{A=""}i.l=A+" ["+i.Z()+"]",Uc(i)}}finally{Pr(i)}}}}function Pr(i,a){if(i.g){qc(i);let u=i.g,d=i.v[0]?()=>{}:null;i.g=null,i.v=null,a||ge(i,"ready");try{u.onreadystatechange=d}catch{}}}function qc(i){i.I&&(l.clearTimeout(i.I),i.I=null)}n.isActive=function(){return!!this.g};function qe(i){return i.g?i.g.readyState:0}n.Z=function(){try{return 2<qe(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(i){if(this.g){var a=this.g.responseText;return i&&a.indexOf(i)==0&&(a=a.substring(i.length)),Cd(a)}};function $c(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.H){case"":case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function Xd(i){let a={};i=(i.g&&2<=qe(i)&&i.g.getAllResponseHeaders()||"").split(`\r
`);for(let d=0;d<i.length;d++){if(F(i[d]))continue;var u=y(i[d]);let E=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let A=a[E]||[];a[E]=A,A.push(u)}I(a,function(d){return d.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ln(i,a,u){return u&&u.internalChannelParams&&u.internalChannelParams[i]||a}function jc(i){this.Aa=0,this.i=[],this.j=new Pn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ln("failFast",!1,i),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ln("baseRetryDelayMs",5e3,i),this.cb=Ln("retryDelaySeedMs",1e4,i),this.Wa=Ln("forwardChannelMaxRetries",2,i),this.wa=Ln("forwardChannelRequestTimeoutMs",2e4,i),this.pa=i&&i.xmlHttpFactory||void 0,this.Xa=i&&i.Tb||void 0,this.Ca=i&&i.useFetchStreams||!1,this.L=void 0,this.J=i&&i.supportsCrossDomainXhr||!1,this.K="",this.h=new Ac(i&&i.concurrentRequestLimit),this.Da=new Hd,this.P=i&&i.fastHandshake||!1,this.O=i&&i.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=i&&i.Rb||!1,i&&i.xa&&this.j.xa(),i&&i.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&i&&i.detectBufferingProxy||!1,this.ja=void 0,i&&i.longPollingTimeout&&0<i.longPollingTimeout&&(this.ja=i.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=jc.prototype,n.la=8,n.G=1,n.connect=function(i,a,u,d){_e(0),this.W=i,this.H=a||{},u&&d!==void 0&&(this.H.OSID=u,this.H.OAID=d),this.F=this.X,this.I=Xc(this,null,this.W),kr(this)};function cs(i){if(zc(i),i.G==3){var a=i.U++,u=Be(i.I);if(K(u,"SID",i.K),K(u,"RID",a),K(u,"TYPE","terminate"),Mn(i,u),a=new Je(i,i.j,a),a.L=2,a.v=Sr(Be(u)),u=!1,l.navigator&&l.navigator.sendBeacon)try{u=l.navigator.sendBeacon(a.v.toString(),"")}catch{}!u&&l.Image&&(new Image().src=a.v,u=!0),u||(a.g=Zc(a.j,null),a.g.ea(a.v)),a.F=Date.now(),Tr(a)}Yc(i)}function Cr(i){i.g&&(ls(i),i.g.cancel(),i.g=null)}function zc(i){Cr(i),i.u&&(l.clearTimeout(i.u),i.u=null),Dr(i),i.h.cancel(),i.s&&(typeof i.s=="number"&&l.clearTimeout(i.s),i.s=null)}function kr(i){if(!bc(i.h)&&!i.s){i.s=!0;var a=i.Ga;In||nc(),En||(In(),En=!0),qi.add(a,i),i.B=0}}function Zd(i,a){return Sc(i.h)>=i.h.j-(i.s?1:0)?!1:i.s?(i.i=a.D.concat(i.i),!0):i.G==1||i.G==2||i.B>=(i.Va?0:i.Wa)?!1:(i.s=Rn(b(i.Ga,i,a),Jc(i,i.B)),i.B++,!0)}n.Ga=function(i){if(this.s)if(this.s=null,this.G==1){if(!i){this.U=Math.floor(1e5*Math.random()),i=this.U++;let E=new Je(this,this.j,i),A=this.o;if(this.S&&(A?(A=p(A),_(A,this.S)):A=this.S),this.m!==null||this.O||(E.H=A,A=null),this.P)e:{for(var a=0,u=0;u<this.i.length;u++){t:{var d=this.i[u];if("__data__"in d.map&&(d=d.map.__data__,typeof d=="string")){d=d.length;break t}d=void 0}if(d===void 0)break;if(a+=d,4096<a){a=u;break e}if(a===4096||u===this.i.length-1){a=u+1;break e}}a=1e3}else a=1e3;a=Gc(this,E,a),u=Be(this.I),K(u,"RID",i),K(u,"CVER",22),this.D&&K(u,"X-HTTP-Session-Id",this.D),Mn(this,u),A&&(this.O?a="headers="+encodeURIComponent(String(Mc(A)))+"&"+a:this.m&&as(u,this.m,A)),os(this.h,E),this.Ua&&K(u,"TYPE","init"),this.P?(K(u,"$req",a),K(u,"SID","null"),E.T=!0,ns(E,u,null)):ns(E,u,a),this.G=2}}else this.G==3&&(i?Wc(this,i):this.i.length==0||bc(this.h)||Wc(this))};function Wc(i,a){var u;a?u=a.l:u=i.U++;let d=Be(i.I);K(d,"SID",i.K),K(d,"RID",u),K(d,"AID",i.T),Mn(i,d),i.m&&i.o&&as(d,i.m,i.o),u=new Je(i,i.j,u,i.B+1),i.m===null&&(u.H=i.o),a&&(i.i=a.D.concat(i.i)),a=Gc(i,u,1e3),u.I=Math.round(.5*i.wa)+Math.round(.5*i.wa*Math.random()),os(i.h,u),ns(u,d,a)}function Mn(i,a){i.H&&se(i.H,function(u,d){K(a,d,u)}),i.l&&Cc({},function(u,d){K(a,d,u)})}function Gc(i,a,u){u=Math.min(i.i.length,u);var d=i.l?b(i.l.Na,i.l,i):null;e:{var E=i.i;let A=-1;for(;;){let P=["count="+u];A==-1?0<u?(A=E[0].g,P.push("ofs="+A)):A=0:P.push("ofs="+A);let W=!0;for(let ce=0;ce<u;ce++){let q=E[ce].g,he=E[ce].map;if(q-=A,0>q)A=Math.max(0,E[ce].g-100),W=!1;else try{Qd(he,P,"req"+q+"_")}catch{d&&d(he)}}if(W){d=P.join("&");break e}}}return i=i.i.splice(0,u),a.D=i,d}function Kc(i){if(!i.g&&!i.u){i.Y=1;var a=i.Fa;In||nc(),En||(In(),En=!0),qi.add(a,i),i.v=0}}function us(i){return i.g||i.u||3<=i.v?!1:(i.Y++,i.u=Rn(b(i.Fa,i),Jc(i,i.v)),i.v++,!0)}n.Fa=function(){if(this.u=null,Hc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var i=2*this.R;this.j.info("BP detection timer enabled: "+i),this.A=Rn(b(this.ab,this),i)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),Cr(this),Hc(this))};function ls(i){i.A!=null&&(l.clearTimeout(i.A),i.A=null)}function Hc(i){i.g=new Je(i,i.j,"rpc",i.Y),i.m===null&&(i.g.H=i.o),i.g.O=0;var a=Be(i.qa);K(a,"RID","rpc"),K(a,"SID",i.K),K(a,"AID",i.T),K(a,"CI",i.F?"0":"1"),!i.F&&i.ja&&K(a,"TO",i.ja),K(a,"TYPE","xmlhttp"),Mn(i,a),i.m&&i.o&&as(a,i.m,i.o),i.L&&(i.g.I=i.L);var u=i.g;i=i.ia,u.L=1,u.v=Sr(Be(a)),u.m=null,u.P=!0,Ec(u,i)}n.Za=function(){this.C!=null&&(this.C=null,Cr(this),us(this),_e(19))};function Dr(i){i.C!=null&&(l.clearTimeout(i.C),i.C=null)}function Qc(i,a){var u=null;if(i.g==a){Dr(i),ls(i),i.g=null;var d=2}else if(ss(i.h,a))u=a.D,Rc(i.h,a),d=1;else return;if(i.G!=0){if(a.o)if(d==1){u=a.m?a.m.length:0,a=Date.now()-a.F;var E=i.B;d=Ir(),ge(d,new _c(d,u)),kr(i)}else Kc(i);else if(E=a.s,E==3||E==0&&0<a.X||!(d==1&&Zd(i,a)||d==2&&us(i)))switch(u&&0<u.length&&(a=i.h,a.i=a.i.concat(u)),E){case 1:ft(i,5);break;case 4:ft(i,10);break;case 3:ft(i,6);break;default:ft(i,2)}}}function Jc(i,a){let u=i.Ta+Math.floor(Math.random()*i.cb);return i.isActive()||(u*=2),u*a}function ft(i,a){if(i.j.info("Error code "+a),a==2){var u=b(i.fb,i),d=i.Xa;let E=!d;d=new dt(d||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Ar(d,"https"),Sr(d),E?Gd(d.toString(),u):Kd(d.toString(),u)}else _e(2);i.G=0,i.l&&i.l.sa(a),Yc(i),zc(i)}n.fb=function(i){i?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))};function Yc(i){if(i.G=0,i.ka=[],i.l){let a=Pc(i.h);(a.length!=0||i.i.length!=0)&&(O(i.ka,a),O(i.ka,i.i),i.h.i.length=0,V(i.i),i.i.length=0),i.l.ra()}}function Xc(i,a,u){var d=u instanceof dt?Be(u):new dt(u);if(d.g!="")a&&(d.g=a+"."+d.g),br(d,d.s);else{var E=l.location;d=E.protocol,a=a?a+"."+E.hostname:E.hostname,E=+E.port;var A=new dt(null);d&&Ar(A,d),a&&(A.g=a),E&&br(A,E),u&&(A.l=u),d=A}return u=i.D,a=i.ya,u&&a&&K(d,u,a),K(d,"VER",i.la),Mn(i,d),d}function Zc(i,a,u){if(a&&!i.J)throw Error("Can't create secondary domain capable XhrIo object.");return a=i.Ca&&!i.pa?new H(new On({eb:u})):new H(i.pa),a.Ha(i.J),a}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function eu(){}n=eu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Nr(){}Nr.prototype.g=function(i,a){return new ve(i,a)};function ve(i,a){le.call(this),this.g=new jc(a),this.l=i,this.h=a&&a.messageUrlParams||null,i=a&&a.messageHeaders||null,a&&a.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.o=i,i=a&&a.initMessageHeaders||null,a&&a.messageContentType&&(i?i["X-WebChannel-Content-Type"]=a.messageContentType:i={"X-WebChannel-Content-Type":a.messageContentType}),a&&a.va&&(i?i["X-WebChannel-Client-Profile"]=a.va:i={"X-WebChannel-Client-Profile":a.va}),this.g.S=i,(i=a&&a.Sb)&&!F(i)&&(this.g.m=i),this.v=a&&a.supportsCrossDomainXhr||!1,this.u=a&&a.sendRawJson||!1,(a=a&&a.httpSessionIdParam)&&!F(a)&&(this.g.D=a,i=this.h,i!==null&&a in i&&(i=this.h,a in i&&delete i[a])),this.j=new qt(this)}k(ve,le),ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ve.prototype.close=function(){cs(this.g)},ve.prototype.o=function(i){var a=this.g;if(typeof i=="string"){var u={};u.__data__=i,i=u}else this.u&&(u={},u.__data__=Ji(i),i=u);a.i.push(new Ld(a.Ya++,i)),a.G==3&&kr(a)},ve.prototype.N=function(){this.g.l=null,delete this.j,cs(this.g),delete this.g,ve.aa.N.call(this)};function tu(i){Xi.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var a=i.__sm__;if(a){e:{for(let u in a){i=u;break e}i=void 0}(this.i=i)&&(i=this.i,a=a!==null&&i in a?a[i]:void 0),this.data=a}else this.data=i}k(tu,Xi);function nu(){Zi.call(this),this.status=1}k(nu,Zi);function qt(i){this.g=i}k(qt,eu),qt.prototype.ua=function(){ge(this.g,"a")},qt.prototype.ta=function(i){ge(this.g,new tu(i))},qt.prototype.sa=function(i){ge(this.g,new nu)},qt.prototype.ra=function(){ge(this.g,"b")},Nr.prototype.createWebChannel=Nr.prototype.g,ve.prototype.send=ve.prototype.o,ve.prototype.open=ve.prototype.m,ve.prototype.close=ve.prototype.close,fo=ze.createWebChannelTransport=function(){return new Nr},ho=ze.getStatEventTarget=function(){return Ir()},lo=ze.Event=lt,ui=ze.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Er.NO_ERROR=0,Er.TIMEOUT=8,Er.HTTP_ERROR=6,Jn=ze.ErrorCode=Er,yc.COMPLETE="complete",uo=ze.EventType=yc,fc.EventType=bn,bn.OPEN="a",bn.CLOSE="b",bn.ERROR="c",bn.MESSAGE="d",le.prototype.listen=le.prototype.K,Qt=ze.WebChannel=fc,Sg=ze.FetchXmlHttpFactory=On,H.prototype.listenOnce=H.prototype.L,H.prototype.getLastError=H.prototype.Ka,H.prototype.getLastErrorCode=H.prototype.Ba,H.prototype.getStatus=H.prototype.Z,H.prototype.getResponseJson=H.prototype.Oa,H.prototype.getResponseText=H.prototype.oa,H.prototype.send=H.prototype.ea,H.prototype.setWithCredentials=H.prototype.Ha,co=ze.XhrIo=H}).apply(typeof ci<"u"?ci:typeof self<"u"?self:typeof window<"u"?window:{});var Il="@firebase/firestore",El="4.8.0";var oe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};oe.UNAUTHENTICATED=new oe(null),oe.GOOGLE_CREDENTIALS=new oe("google-credentials-uid"),oe.FIRST_PARTY=new oe("first-party-uid"),oe.MOCK_USER=new oe("mock-user");var _n="11.10.0";var Dt=new Oe("@firebase/firestore");function Jt(){return Dt.logLevel}function D(n,...e){if(Dt.logLevel<=M.DEBUG){let t=e.map(Ba);Dt.debug(`Firestore (${_n}): ${n}`,...t)}}function Nt(n,...e){if(Dt.logLevel<=M.ERROR){let t=e.map(Ba);Dt.error(`Firestore (${_n}): ${n}`,...t)}}function rn(n,...e){if(Dt.logLevel<=M.WARN){let t=e.map(Ba);Dt.warn(`Firestore (${_n}): ${n}`,...t)}}function Ba(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function x(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,nh(n,r,t)}function nh(n,e,t){let r=`FIRESTORE (${_n}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Nt(r),new Error(r)}function J(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||nh(e,s,r)}function G(n,e){return n}var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},N=class extends Ae{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var We=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var gi=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},_o=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(oe.UNAUTHENTICATED))}shutdown(){}},yo=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},vo=class{constructor(e){this.t=e,this.currentUser=oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){J(this.o===void 0,42304);let r=this.i,s=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new We;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new We,e.enqueueRetryable(()=>s(this.currentUser))};let c=()=>{let h=o;e.enqueueRetryable(async()=>{await h.promise,await s(this.currentUser)})},l=h=>{D("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?l(h):(D("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new We)}},0),c()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(D("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(J(typeof r.accessToken=="string",31837,{l:r}),new gi(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string",2055,{h:e}),new oe(e)}},Io=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=oe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Eo=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Io(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_i=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},wo=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,je(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){J(this.o===void 0,3512);let r=o=>{o.error!=null&&D("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let c=o.token!==this.m;return this.m=o.token,D("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let s=o=>{D("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?s(o):D("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new _i(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(J(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new _i(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Rg(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Pg(){return new TextEncoder}var rr=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let s=Rg(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<t&&(r+=e.charAt(s[o]%62))}return r}};function B(n,e){return n<e?-1:n>e?1:0}function To(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return B(r,s);{let o=Pg(),c=Cg(o.encode(wl(n,t)),o.encode(wl(e,t)));return c!==0?c:B(r,s)}}t+=r>65535?2:1}return B(n.length,e.length)}function wl(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function Cg(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return B(n[t],e[t]);return B(n.length,e.length)}function sn(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}var Tl="__name__",yi=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&x(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&x(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let s=0;s<r;s++){let o=n.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return B(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),s=n.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?n.extractNumericId(e).compare(n.extractNumericId(t)):To(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ai.fromString(e.substring(4,e.length-2))}},Z=class n extends yi{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new N(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new n(t)}static emptyPath(){return new n([])}},kg=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ee=class n extends yi{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return kg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Tl}static keyField(){return new n([Tl])}static fromServerFormat(e){let t=[],r="",s=0,o=()=>{if(r.length===0)throw new N(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},c=!1;for(;s<e.length;){let l=e[s];if(l==="\\"){if(s+1===e.length)throw new N(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new N(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,s+=2}else l==="`"?(c=!c,s++):l!=="."||c?(r+=l,s++):(o(),s++)}if(o(),c)throw new N(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(Z.fromString(e))}static fromName(e){return new n(Z.fromString(e).popFirst(5))}static empty(){return new n(Z.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Z.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Z.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Z(e.slice()))}};function rh(n,e,t){if(!t)throw new N(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Dg(n,e,t,r){if(e===!0&&r===!0)throw new N(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Al(n){if(!L.isDocumentKey(n))throw new N(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function bl(n){if(L.isDocumentKey(n))throw new N(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ih(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function qa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":x(12329,{type:typeof n})}function sh(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new N(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=qa(n);throw new N(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function re(n,e){let t={typeString:n};return e&&(t.value=e),t}function hr(n,e){if(!ih(n))throw new N(S.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let s=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let c=n[r];if(s&&typeof c!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(o!==void 0&&c!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new N(S.INVALID_ARGUMENT,t);return!0}var Sl=-62135596800,Rl=1e6,ie=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Rl);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Sl)throw new N(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Rl}_compareTo(e){return this.seconds===e.seconds?B(this.nanoseconds,e.nanoseconds):B(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(hr(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Sl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ie._jsonSchemaVersion="firestore/timestamp/1.0",ie._jsonSchema={type:re("string",ie._jsonSchemaVersion),seconds:re("number"),nanoseconds:re("number")};var Q=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ie(0,0))}static max(){return new n(new ie(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ir=-1,Ao=class{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}};Ao.UNKNOWN_ID=-1;function Ng(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Q.fromTimestamp(r===1e9?new ie(t+1,0):new ie(t,r));return new Ot(s,L.empty(),e)}function Og(n){return new Ot(n.readTime,n.key,ir)}var Ot=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Q.min(),L.empty(),ir)}static max(){return new n(Q.max(),L.empty(),ir)}};function Vg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:B(n.largestBatchId,e.largestBatchId))}var xg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",bo=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function $a(n){if(n.code!==S.FAILED_PRECONDITION||n.message!==xg)throw n;D("LocalStore","Unexpectedly lost primary lease")}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&x(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let s=0,o=0,c=!1;e.forEach(l=>{++s,l.next(()=>{++o,c&&o===s&&t()},h=>r(h))}),c=!0,o===s&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(s=>s?n.resolve(s):r());return t}static forEach(e,t){let r=[];return e.forEach((s,o)=>{r.push(t.call(this,s,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,s)=>{let o=e.length,c=new Array(o),l=0;for(let h=0;h<o;h++){let f=h;t(e[f]).next(v=>{c[f]=v,++l,l===o&&r(c)},v=>s(v))}})}static doWhile(e,t){return new n((r,s)=>{let o=()=>{e()===!0?t().next(()=>{o()},s):r()};o()})}};function Lg(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function dr(n){return n.name==="IndexedDbTransactionError"}var oh=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=s=>this._e(s),this.ae=s=>r.writeSequenceNumber(s))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),ja=-1;function za(n){return n==null}function sr(n){return n===0&&1/n==-1/0}function Mg(n){return typeof n=="number"&&Number.isInteger(n)&&!sr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var ah="";function Fg(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Pl(e)),e=Ug(n.get(t),e);return Pl(e)}function Ug(n,e){let t=e,r=n.length;for(let s=0;s<r;s++){let o=n.charAt(s);switch(o){case"\0":t+="";break;case ah:t+="";break;default:t+=o}}return t}function Pl(n){return n+ah+""}var Bg="remoteDocuments",ch="owner";var uh="mutationQueues";var lh="mutations";var hh="documentMutations",qg="remoteDocumentsV14";var dh="remoteDocumentGlobal";var fh="targets";var ph="targetDocuments";var mh="targetGlobal",gh="collectionParents";var _h="clientMetadata";var yh="bundles";var vh="namedQueries";var $g="indexConfiguration";var jg="indexState";var zg="indexEntries";var Ih="documentOverlays";var Wg="globals";var Gg=[uh,lh,hh,Bg,fh,ch,mh,ph,_h,dh,gh,yh,vh],cE=[...Gg,Ih],Kg=[uh,lh,hh,qg,fh,ch,mh,ph,_h,dh,gh,yh,vh,Ih],Hg=Kg,Qg=[...Hg,$g,jg,zg];var uE=[...Qg,Wg];function Cl(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function yn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Eh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Te=class n{constructor(e,t){this.comparator=e,this.root=t||Me.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Me.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Me.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xt(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xt(this.root,e,this.comparator,!0)}},Xt=class{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Me=class n{constructor(e,t,r,s,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,o){return new n(e??this.key,t??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this,o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,r),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return n.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw x(43730,{key:this.key,value:this.value});if(this.right.isRed())throw x(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw x(27949);return e+(this.isRed()?0:1)}};Me.EMPTY=null,Me.RED=!0,Me.BLACK=!1;Me.EMPTY=new class{constructor(){this.size=0}get key(){throw x(57766)}get value(){throw x(16141)}get color(){throw x(16727)}get left(){throw x(29726)}get right(){throw x(36894)}copy(e,t,r,s,o){return this}insert(e,t,r){return new Me(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var me=class n{constructor(e){this.comparator=e,this.data=new Te(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vi(this.data.getIterator())}getIteratorFrom(e){return new vi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let s=t.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},vi=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Le=class n{constructor(e){this.fields=e,e.sort(Ee.comparator)}static empty(){return new n([])}unionWith(e){let t=new me(Ee.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var So=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ge=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new So("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return B(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ge.EMPTY_BYTE_STRING=new Ge("");var Jg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ot(n){if(J(!!n,39018),typeof n=="string"){let e=0,t=Jg.exec(n);if(J(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ne(n.seconds),nanos:ne(n.nanos)}}function ne(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Vt(n){return typeof n=="string"?Ge.fromBase64String(n):Ge.fromUint8Array(n)}var wh="server_timestamp",Th="__type__",Ah="__previous_value__",bh="__local_write_time__";function Wa(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Th])===null||t===void 0?void 0:t.stringValue)===wh}function Ga(n){let e=n.mapValue.fields[Ah];return Wa(e)?Ga(e):e}function Ii(n){let e=ot(n.mapValue.fields[bh].timestampValue);return new ie(e.seconds,e.nanos)}var Ro=class{constructor(e,t,r,s,o,c,l,h,f,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=v}},Ei="(default)",Po=class n{constructor(e,t){this.projectId=e,this.database=t||Ei}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Ei}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ka="__type__",Sh="__max__",li={mapValue:{fields:{__type__:{stringValue:Sh}}}},Ha="__vector__",or="value";function xt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Wa(n)?4:Ph(n)?9007199254740991:Rh(n)?10:11:x(28295,{value:n})}function Fe(n,e){if(n===e)return!0;let t=xt(n);if(t!==xt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ii(n).isEqual(Ii(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;let c=ot(s.timestampValue),l=ot(o.timestampValue);return c.seconds===l.seconds&&c.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,o){return Vt(s.bytesValue).isEqual(Vt(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,o){return ne(s.geoPointValue.latitude)===ne(o.geoPointValue.latitude)&&ne(s.geoPointValue.longitude)===ne(o.geoPointValue.longitude)})(n,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return ne(s.integerValue)===ne(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){let c=ne(s.doubleValue),l=ne(o.doubleValue);return c===l?sr(c)===sr(l):isNaN(c)&&isNaN(l)}return!1})(n,e);case 9:return sn(n.arrayValue.values||[],e.arrayValue.values||[],Fe);case 10:case 11:return(function(s,o){let c=s.mapValue.fields||{},l=o.mapValue.fields||{};if(Cl(c)!==Cl(l))return!1;for(let h in c)if(c.hasOwnProperty(h)&&(l[h]===void 0||!Fe(c[h],l[h])))return!1;return!0})(n,e);default:return x(52216,{left:n})}}function ar(n,e){return(n.values||[]).find(t=>Fe(t,e))!==void 0}function on(n,e){if(n===e)return 0;let t=xt(n),r=xt(e);if(t!==r)return B(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return B(n.booleanValue,e.booleanValue);case 2:return(function(o,c){let l=ne(o.integerValue||o.doubleValue),h=ne(c.integerValue||c.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1})(n,e);case 3:return kl(n.timestampValue,e.timestampValue);case 4:return kl(Ii(n),Ii(e));case 5:return To(n.stringValue,e.stringValue);case 6:return(function(o,c){let l=Vt(o),h=Vt(c);return l.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){let l=o.split("/"),h=c.split("/");for(let f=0;f<l.length&&f<h.length;f++){let v=B(l[f],h[f]);if(v!==0)return v}return B(l.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){let l=B(ne(o.latitude),ne(c.latitude));return l!==0?l:B(ne(o.longitude),ne(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Dl(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var l,h,f,v;let w=o.fields||{},b=c.fields||{},C=(l=w[or])===null||l===void 0?void 0:l.arrayValue,k=(h=b[or])===null||h===void 0?void 0:h.arrayValue,V=B(((f=C?.values)===null||f===void 0?void 0:f.length)||0,((v=k?.values)===null||v===void 0?void 0:v.length)||0);return V!==0?V:Dl(C,k)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===li.mapValue&&c===li.mapValue)return 0;if(o===li.mapValue)return 1;if(c===li.mapValue)return-1;let l=o.fields||{},h=Object.keys(l),f=c.fields||{},v=Object.keys(f);h.sort(),v.sort();for(let w=0;w<h.length&&w<v.length;++w){let b=To(h[w],v[w]);if(b!==0)return b;let C=on(l[h[w]],f[v[w]]);if(C!==0)return C}return B(h.length,v.length)})(n.mapValue,e.mapValue);default:throw x(23264,{le:t})}}function kl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return B(n,e);let t=ot(n),r=ot(e),s=B(t.seconds,r.seconds);return s!==0?s:B(t.nanos,r.nanos)}function Dl(n,e){let t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){let o=on(t[s],r[s]);if(o)return o}return B(t.length,r.length)}function an(n){return Co(n)}function Co(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=ot(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Vt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return L.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(let o of t.values||[])s?s=!1:r+=",",r+=Co(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),s="{",o=!0;for(let c of r)o?o=!1:s+=",",s+=`${c}:${Co(t.fields[c])}`;return s+"}"})(n.mapValue):x(61005,{value:n})}function fi(n){switch(xt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Ga(n);return e?16+fi(e):16;case 5:return 2*n.stringValue.length;case 6:return Vt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((s,o)=>s+fi(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return yn(r.fields,(o,c)=>{s+=o.length+fi(c)}),s})(n.mapValue);default:throw x(13486,{value:n})}}function ko(n){return!!n&&"integerValue"in n}function Qa(n){return!!n&&"arrayValue"in n}function pi(n){return!!n&&"mapValue"in n}function Rh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Ka])===null||t===void 0?void 0:t.stringValue)===Ha}function Xn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return yn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Xn(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xn(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ph(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Sh}var hE={mapValue:{fields:{[Ka]:{stringValue:Ha},[or]:{arrayValue:{}}}}};var xe=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!pi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xn(t)}setAll(e){let t=Ee.emptyPath(),r={},s=[];e.forEach((c,l)=>{if(!t.isImmediateParentOf(l)){let h=this.getFieldsMap(t);this.applyChanges(h,r,s),r={},s=[],t=l.popLast()}c?r[l.lastSegment()]=Xn(c):s.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,s)}delete(e){let t=this.field(e.popLast());pi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fe(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];pi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){yn(t,(s,o)=>e[s]=o);for(let s of r)delete e[s]}clone(){return new n(Xn(this.value))}};function Ch(n){let e=[];return yn(n.fields,(t,r)=>{let s=new Ee([t]);if(pi(r)){let o=Ch(r.mapValue).fields;if(o.length===0)e.push(s);else for(let c of o)e.push(s.child(c))}else e.push(s)}),new Le(e)}var cn=class n{constructor(e,t,r,s,o,c,l){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=o,this.data=c,this.documentState=l}static newInvalidDocument(e){return new n(e,0,Q.min(),Q.min(),Q.min(),xe.empty(),0)}static newFoundDocument(e,t,r,s){return new n(e,1,t,Q.min(),r,s,0)}static newNoDocument(e,t){return new n(e,2,t,Q.min(),Q.min(),xe.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Q.min(),Q.min(),xe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var un=class{constructor(e,t){this.position=e,this.inclusive=t}};function Nl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){let o=e[s],c=n.position[s];if(o.field.isKeyField()?r=L.comparator(L.fromName(c.referenceValue),t.key):r=on(c,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ol(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Fe(n.position[t],e.position[t]))return!1;return!0}var ln=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Yg(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var wi=class{},ae=class n extends wi{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new No(e,t,r):t==="array-contains"?new xo(e,r):t==="in"?new Lo(e,r):t==="not-in"?new Mo(e,r):t==="array-contains-any"?new Fo(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Oo(e,r):new Vo(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(on(t,this.value)):t!==null&&xt(this.value)===xt(t)&&this.matchesComparison(on(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return x(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},at=class n extends wi{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return kh(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function kh(n){return n.op==="and"}function Dh(n){return Xg(n)&&kh(n)}function Xg(n){for(let e of n.filters)if(e instanceof at)return!1;return!0}function Do(n){if(n instanceof ae)return n.field.canonicalString()+n.op.toString()+an(n.value);if(Dh(n))return n.filters.map(e=>Do(e)).join(",");{let e=n.filters.map(t=>Do(t)).join(",");return`${n.op}(${e})`}}function Nh(n,e){return n instanceof ae?(function(r,s){return s instanceof ae&&r.op===s.op&&r.field.isEqual(s.field)&&Fe(r.value,s.value)})(n,e):n instanceof at?(function(r,s){return s instanceof at&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((o,c,l)=>o&&Nh(c,s.filters[l]),!0):!1})(n,e):void x(19439)}function Oh(n){return n instanceof ae?(function(t){return`${t.field.canonicalString()} ${t.op} ${an(t.value)}`})(n):n instanceof at?(function(t){return t.op.toString()+" {"+t.getFilters().map(Oh).join(" ,")+"}"})(n):"Filter"}var No=class extends ae{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},Oo=class extends ae{constructor(e,t){super(e,"in",t),this.keys=Vh("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Vo=class extends ae{constructor(e,t){super(e,"not-in",t),this.keys=Vh("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Vh(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var xo=class extends ae{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Qa(t)&&ar(t.arrayValue,this.value)}},Lo=class extends ae{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ar(this.value.arrayValue,t)}},Mo=class extends ae{constructor(e,t){super(e,"not-in",t)}matches(e){if(ar(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ar(this.value.arrayValue,t)}},Fo=class extends ae{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Qa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ar(this.value.arrayValue,r))}};var Uo=class{constructor(e,t=null,r=[],s=[],o=null,c=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=c,this.endAt=l,this.Pe=null}};function Vl(n,e=null,t=[],r=[],s=null,o=null,c=null){return new Uo(n,e,t,r,s,o,c)}function Ja(n){let e=G(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Do(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),za(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>an(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>an(r)).join(",")),e.Pe=t}return e.Pe}function Ya(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Yg(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Nh(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ol(n.startAt,e.startAt)&&Ol(n.endAt,e.endAt)}var hn=class{constructor(e,t=null,r=[],s=[],o=null,c="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=c,this.startAt=l,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function Zg(n,e,t,r,s,o,c,l){return new hn(n,e,t,r,s,o,c,l)}function e_(n){return new hn(n)}function xl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function t_(n){return n.collectionGroup!==null}function Zn(n){let e=G(n);if(e.Te===null){e.Te=[];let t=new Set;for(let o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let l=new me(Ee.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new ln(o,r))}),t.has(Ee.keyField().canonicalString())||e.Te.push(new ln(Ee.keyField(),r))}return e.Te}function St(n){let e=G(n);return e.Ie||(e.Ie=n_(e,Zn(n))),e.Ie}function n_(n,e){if(n.limitType==="F")return Vl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{let o=s.dir==="desc"?"asc":"desc";return new ln(s.field,o)});let t=n.endAt?new un(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new un(n.startAt.position,n.startAt.inclusive):null;return Vl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Bo(n,e,t){return new hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function xh(n,e){return Ya(St(n),St(e))&&n.limitType===e.limitType}function Lh(n){return`${Ja(St(n))}|lt:${n.limitType}`}function Yn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>Oh(s)).join(", ")}]`),za(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>an(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>an(s)).join(",")),`Target(${r})`})(St(n))}; limitType=${n.limitType})`}function Xa(n,e){return e.isFoundDocument()&&(function(r,s){let o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,s){for(let o of Zn(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(let o of r.filters)if(!o.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(c,l,h){let f=Nl(c,l,h);return c.inclusive?f<=0:f<0})(r.startAt,Zn(r),s)||r.endAt&&!(function(c,l,h){let f=Nl(c,l,h);return c.inclusive?f>=0:f>0})(r.endAt,Zn(r),s))})(n,e)}function r_(n){return(e,t)=>{let r=!1;for(let s of Zn(n)){let o=i_(s,e,t);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function i_(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):(function(o,c,l){let h=c.data.field(o),f=l.data.field(o);return h!==null&&f!==null?on(h,f):x(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return x(19790,{direction:n.dir})}}var Ke=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){yn(this.inner,(t,r)=>{for(let[s,o]of r)e(s,o)})}isEmpty(){return Eh(this.inner)}size(){return this.innerSize}};var s_=new Te(L.comparator);function Ti(){return s_}var Mh=new Te(L.comparator);function hi(...n){let e=Mh;for(let t of n)e=e.insert(t.key,t);return e}function Fh(n){let e=Mh;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function bt(){return er()}function Uh(){return er()}function er(){return new Ke(n=>n.toString(),(n,e)=>n.isEqual(e))}var o_=new Te(L.comparator),a_=new me(L.comparator);function pe(...n){let e=a_;for(let t of n)e=e.add(t);return e}var c_=new me(B);function u_(){return c_}function Za(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sr(e)?"-0":e}}function Bh(n){return{integerValue:""+n}}function l_(n,e){return Mg(e)?Bh(e):Za(n,e)}var dn=class{constructor(){this._=void 0}};function h_(n,e,t){return n instanceof fn?(function(s,o){let c={fields:{[Th]:{stringValue:wh},[bh]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Wa(o)&&(o=Ga(o)),o&&(c.fields[Ah]=o),{mapValue:c}})(t,e):n instanceof Lt?$h(n,e):n instanceof Mt?jh(n,e):(function(s,o){let c=qh(s,o),l=Ll(c)+Ll(s.Ee);return ko(c)&&ko(s.Ee)?Bh(l):Za(s.serializer,l)})(n,e)}function d_(n,e,t){return n instanceof Lt?$h(n,e):n instanceof Mt?jh(n,e):t}function qh(n,e){return n instanceof pn?(function(r){return ko(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var fn=class extends dn{},Lt=class extends dn{constructor(e){super(),this.elements=e}};function $h(n,e){let t=zh(e);for(let r of n.elements)t.some(s=>Fe(s,r))||t.push(r);return{arrayValue:{values:t}}}var Mt=class extends dn{constructor(e){super(),this.elements=e}};function jh(n,e){let t=zh(e);for(let r of n.elements)t=t.filter(s=>!Fe(s,r));return{arrayValue:{values:t}}}var pn=class extends dn{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function Ll(n){return ne(n.integerValue||n.doubleValue)}function zh(n){return Qa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function f_(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Lt&&s instanceof Lt||r instanceof Mt&&s instanceof Mt?sn(r.elements,s.elements,Fe):r instanceof pn&&s instanceof pn?Fe(r.Ee,s.Ee):r instanceof fn&&s instanceof fn})(n.transform,e.transform)}var qo=class{constructor(e,t){this.version=e,this.transformResults=t}},Rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function mi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var mn=class{};function Wh(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ai(n.key,Rt.none()):new Ft(n.key,n.data,Rt.none());{let t=n.data,r=xe.empty(),s=new me(Ee.comparator);for(let o of e.fields)if(!s.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?r.delete(o):r.set(o,c),s=s.add(o)}return new He(n.key,r,new Le(s.toArray()),Rt.none())}}function p_(n,e,t){n instanceof Ft?(function(s,o,c){let l=s.value.clone(),h=Fl(s.fieldTransforms,o,c.transformResults);l.setAll(h),o.convertToFoundDocument(c.version,l).setHasCommittedMutations()})(n,e,t):n instanceof He?(function(s,o,c){if(!mi(s.precondition,o))return void o.convertToUnknownDocument(c.version);let l=Fl(s.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(Gh(s)),h.setAll(l),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):(function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function tr(n,e,t,r){return n instanceof Ft?(function(o,c,l,h){if(!mi(o.precondition,c))return l;let f=o.value.clone(),v=Ul(o.fieldTransforms,h,c);return f.setAll(v),c.convertToFoundDocument(c.version,f).setHasLocalMutations(),null})(n,e,t,r):n instanceof He?(function(o,c,l,h){if(!mi(o.precondition,c))return l;let f=Ul(o.fieldTransforms,h,c),v=c.data;return v.setAll(Gh(o)),v.setAll(f),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(w=>w.field))})(n,e,t,r):(function(o,c,l){return mi(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):l})(n,e,t)}function m_(n,e){let t=null;for(let r of n.fieldTransforms){let s=e.data.field(r.field),o=qh(r.transform,s||null);o!=null&&(t===null&&(t=xe.empty()),t.set(r.field,o))}return t||null}function Ml(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&sn(r,s,(o,c)=>f_(o,c))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ft=class extends mn{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}},He=class extends mn{constructor(e,t,r,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Gh(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Fl(n,e,t){let r=new Map;J(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let s=0;s<t.length;s++){let o=n[s],c=o.transform,l=e.data.field(o.field);r.set(o.field,d_(c,l,t[s]))}return r}function Ul(n,e,t){let r=new Map;for(let s of n){let o=s.transform,c=t.data.field(s.field);r.set(s.field,h_(o,c,e))}return r}var Ai=class extends mn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},$o=class extends mn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var jo=class{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){let o=this.mutations[s];o.key.isEqual(e.key)&&p_(o,e,r[s])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=tr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=tr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Uh();return this.mutations.forEach(s=>{let o=e.get(s.key),c=o.overlayedDocument,l=this.applyToLocalView(c,o.mutatedFields);l=t.has(s.key)?null:l;let h=Wh(c,l);h!==null&&r.set(s.key,h),c.isValidDocument()||c.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&sn(this.mutations,e.mutations,(t,r)=>Ml(t,r))&&sn(this.baseMutations,e.baseMutations,(t,r)=>Ml(t,r))}},zo=class n{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){J(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=(function(){return o_})(),o=e.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,r[c].version);return new n(e,t,r,s)}};var Wo=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ee,U;function g_(n){switch(n){case S.OK:return x(64938);case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0;default:return x(15467,{code:n})}}function __(n){if(n===void 0)return Nt("GRPC error has no .code"),S.UNKNOWN;switch(n){case ee.OK:return S.OK;case ee.CANCELLED:return S.CANCELLED;case ee.UNKNOWN:return S.UNKNOWN;case ee.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case ee.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case ee.INTERNAL:return S.INTERNAL;case ee.UNAVAILABLE:return S.UNAVAILABLE;case ee.UNAUTHENTICATED:return S.UNAUTHENTICATED;case ee.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case ee.NOT_FOUND:return S.NOT_FOUND;case ee.ALREADY_EXISTS:return S.ALREADY_EXISTS;case ee.PERMISSION_DENIED:return S.PERMISSION_DENIED;case ee.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case ee.ABORTED:return S.ABORTED;case ee.OUT_OF_RANGE:return S.OUT_OF_RANGE;case ee.UNIMPLEMENTED:return S.UNIMPLEMENTED;case ee.DATA_LOSS:return S.DATA_LOSS;default:return x(39323,{code:n})}}(U=ee||(ee={}))[U.OK=0]="OK",U[U.CANCELLED=1]="CANCELLED",U[U.UNKNOWN=2]="UNKNOWN",U[U.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",U[U.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",U[U.NOT_FOUND=5]="NOT_FOUND",U[U.ALREADY_EXISTS=6]="ALREADY_EXISTS",U[U.PERMISSION_DENIED=7]="PERMISSION_DENIED",U[U.UNAUTHENTICATED=16]="UNAUTHENTICATED",U[U.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",U[U.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",U[U.ABORTED=10]="ABORTED",U[U.OUT_OF_RANGE=11]="OUT_OF_RANGE",U[U.UNIMPLEMENTED=12]="UNIMPLEMENTED",U[U.INTERNAL=13]="INTERNAL",U[U.UNAVAILABLE=14]="UNAVAILABLE",U[U.DATA_LOSS=15]="DATA_LOSS";var dE=new ai([4294967295,4294967295],0);var Go=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ko(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function y_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function v_(n,e){return Ko(n,e.toTimestamp())}function en(n){return J(!!n,49232),Q.fromTimestamp((function(t){let r=ot(t);return new ie(r.seconds,r.nanos)})(n))}function Kh(n,e){return Ho(n,e).canonicalString()}function Ho(n,e){let t=(function(s){return new Z(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function I_(n){let e=Z.fromString(n);return J(P_(e),10190,{key:e.toString()}),e}function Qo(n,e){return Kh(n.databaseId,e.path)}function E_(n){let e=I_(n);return e.length===4?Z.emptyPath():T_(e)}function w_(n){return new Z(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function T_(n){return J(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Bl(n,e,t){return{name:Qo(n,e),fields:t.value.mapValue.fields}}function A_(n,e){let t;if(e instanceof Ft)t={update:Bl(n,e.key,e.value)};else if(e instanceof Ai)t={delete:Qo(n,e.key)};else if(e instanceof He)t={update:Bl(n,e.key,e.data),updateMask:R_(e.fieldMask)};else{if(!(e instanceof $o))return x(16599,{Rt:e.type});t={verify:Qo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,c){let l=c.transform;if(l instanceof fn)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Lt)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Mt)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof pn)return{fieldPath:c.field.canonicalString(),increment:l.Ee};throw x(20930,{transform:c.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:v_(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:x(27497)})(n,e.precondition)),t}function b_(n,e){return n&&n.length>0?(J(e!==void 0,14353),n.map(t=>(function(s,o){let c=s.updateTime?en(s.updateTime):en(o);return c.isEqual(Q.min())&&(c=en(o)),new qo(c,s.transformResults||[])})(t,e))):[]}function S_(n){let e=E_(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,s=null;if(r>0){J(r===1,65062);let v=t.from[0];v.allDescendants?s=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=(function(w){let b=Hh(w);return b instanceof at&&Dh(b)?b.getFilters():[b]})(t.where));let c=[];t.orderBy&&(c=(function(w){return w.map(b=>(function(k){return new ln(Yt(k.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(b))})(t.orderBy));let l=null;t.limit&&(l=(function(w){let b;return b=typeof w=="object"?w.value:w,za(b)?null:b})(t.limit));let h=null;t.startAt&&(h=(function(w){let b=!!w.before,C=w.values||[];return new un(C,b)})(t.startAt));let f=null;return t.endAt&&(f=(function(w){let b=!w.before,C=w.values||[];return new un(C,b)})(t.endAt)),Zg(e,s,c,o,l,"F",h,f)}function Hh(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Yt(t.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":let s=Yt(t.unaryFilter.field);return ae.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Yt(t.unaryFilter.field);return ae.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let c=Yt(t.unaryFilter.field);return ae.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return x(61313);default:return x(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ae.create(Yt(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return x(58110);default:return x(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return at.create(t.compositeFilter.filters.map(r=>Hh(r)),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return x(1026)}})(t.compositeFilter.op))})(n):x(30097,{filter:n})}function Yt(n){return Ee.fromServerFormat(n.fieldPath)}function R_(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function P_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Jo=class{constructor(e){this.gt=e}};function C_(n){let e=S_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Bo(e,e.limit,"L"):e}var bi=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ne(e.integerValue));else if("doubleValue"in e){let r=ne(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),sr(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=ot(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(Vt(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?Ph(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Rh(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):x(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let s of Object.keys(r))this.xt(s,t),this.Dt(r[s],t)}Lt(e,t){var r,s;let o=e.fields||{};this.Ct(t,53);let c=or,l=((s=(r=o[c].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Ct(t,15),t.Ft(ne(l)),this.xt(c,t),this.Dt(o[c],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let s of r)this.Dt(s,t)}Bt(e,t){this.Ct(t,37),L.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};bi.Ut=new bi;var Yo=class{constructor(){this.Dn=new Xo}addToCollectionParentIndex(e,t){return this.Dn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Ot.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Ot.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},Xo=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new me(Z.comparator),o=!s.has(r);return this.index[t]=s.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new me(Z.comparator)).toArray()}};var fE=new Uint8Array(0);var ql={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qh=41943040,Se=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Se.DEFAULT_COLLECTION_PERCENTILE=10,Se.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Se.DEFAULT=new Se(Qh,Se.DEFAULT_COLLECTION_PERCENTILE,Se.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Se.DISABLED=new Se(-1,0,0);var cr=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var $l="LruGarbageCollector",k_=1048576;function jl([n,e],[t,r]){let s=B(n,t);return s===0?B(e,r):s}var Zo=class{constructor(e){this.Tr=e,this.buffer=new me(jl),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();jl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},ea=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){D($l,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){dr(t)?D($l,"Ignoring IndexedDB error during garbage collection: ",t):await $a(t)}await this.Rr(3e5)})}},ta=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(oh.ue);let r=new Zo(t);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(D("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(ql)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(D("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ql):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,s,o,c,l,h,f,v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(D("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),s=this.params.maximumSequenceNumbersToCollect):s=w,c=Date.now(),this.nthSequenceNumber(e,s))).next(w=>(r=w,l=Date.now(),this.removeTargets(e,r,t))).next(w=>(o=w,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(w=>(f=Date.now(),Jt()<=M.DEBUG&&D("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${s} in `+(l-c)+`ms
	Removed ${o} targets in `+(h-l)+`ms
	Removed ${w} documents in `+(f-h)+`ms
Total Duration: ${f-v}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:w})))}};function D_(n,e){return new ta(n,e)}var na=class{constructor(){this.changes=new Ke(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ra=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ia=class{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&tr(r.mutation,s,Le.empty(),ie.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pe()){let s=bt();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(o=>{let c=hi();return o.forEach((l,h)=>{c=c.insert(l,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){let r=bt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pe()))}populateOverlays(e,t,r){let s=[];return r.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((c,l)=>{t.set(c,l)})})}computeViews(e,t,r,s){let o=Ti(),c=er(),l=(function(){return er()})();return t.forEach((h,f)=>{let v=r.get(f.key);s.has(f.key)&&(v===void 0||v.mutation instanceof He)?o=o.insert(f.key,f):v!==void 0?(c.set(f.key,v.mutation.getFieldMask()),tr(v.mutation,f,v.mutation.getFieldMask(),ie.now())):c.set(f.key,Le.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((f,v)=>c.set(f,v)),t.forEach((f,v)=>{var w;return l.set(f,new ra(v,(w=c.get(f))!==null&&w!==void 0?w:null))}),l))}recalculateAndSaveOverlays(e,t){let r=er(),s=new Te((c,l)=>c-l),o=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(let l of c)l.keys().forEach(h=>{let f=t.get(h);if(f===null)return;let v=r.get(h)||Le.empty();v=l.applyToLocalView(f,v),r.set(h,v);let w=(s.get(l.batchId)||pe()).add(h);s=s.insert(l.batchId,w)})}).next(()=>{let c=[],l=s.getReverseIterator();for(;l.hasNext();){let h=l.getNext(),f=h.key,v=h.value,w=Uh();v.forEach(b=>{if(!o.has(b)){let C=Wh(t.get(b),r.get(b));C!==null&&w.set(b,C),o=o.add(b)}}),c.push(this.documentOverlayCache.saveOverlays(e,f,w))}return R.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return(function(c){return L.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):t_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(o=>{let c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-o.size):R.resolve(bt()),l=ir,h=o;return c.next(f=>R.forEach(f,(v,w)=>(l<w.largestBatchId&&(l=w.largestBatchId),o.get(v)?R.resolve():this.remoteDocumentCache.getEntry(e,v).next(b=>{h=h.insert(v,b)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,h,f,pe())).next(v=>({batchId:l,changes:Fh(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let s=hi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){let o=t.collectionGroup,c=hi();return this.indexManager.getCollectionParents(e,o).next(l=>R.forEach(l,h=>{let f=(function(w,b){return new hn(b,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,s).next(v=>{v.forEach((w,b)=>{c=c.insert(w,b)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,s))).next(c=>{o.forEach((h,f)=>{let v=f.getKey();c.get(v)===null&&(c=c.insert(v,cn.newInvalidDocument(v)))});let l=hi();return c.forEach((h,f)=>{let v=o.get(h);v!==void 0&&tr(v.mutation,f,Le.empty(),ie.now()),Xa(t,f)&&(l=l.insert(h,f))}),l})}};var sa=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return R.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:en(s.createTime)}})(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(s){return{name:s.name,query:C_(s.bundledQuery),readTime:en(s.readTime)}})(t)),R.resolve()}};var oa=class{constructor(){this.overlays=new Te(L.comparator),this.kr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=bt();return R.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,o)=>{this.wt(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let s=this.kr.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let s=bt(),o=t.length+1,c=new L(t.child("")),l=this.overlays.getIteratorFrom(c);for(;l.hasNext();){let h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&h.largestBatchId>r&&s.set(h.getKey(),h)}return R.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let o=new Te((f,v)=>f-v),c=this.overlays.getIterator();for(;c.hasNext();){let f=c.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let v=o.get(f.largestBatchId);v===null&&(v=bt(),o=o.insert(f.largestBatchId,v)),v.set(f.getKey(),f)}}let l=bt(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,v)=>l.set(f,v)),!(l.size()>=s)););return R.resolve(l)}wt(e,t,r){let s=this.overlays.get(r.key);if(s!==null){let c=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new Wo(t,r));let o=this.kr.get(t);o===void 0&&(o=pe(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}};var aa=class{constructor(){this.sessionToken=Ge.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var ur=class{constructor(){this.qr=new me(te.Qr),this.$r=new me(te.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new te(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new te(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new L(new Z([])),r=new te(t,e),s=new te(t,e+1),o=[];return this.$r.forEachInRange([r,s],c=>{this.Wr(c),o.push(c.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new L(new Z([])),r=new te(t,e),s=new te(t,e+1),o=pe();return this.$r.forEachInRange([r,s],c=>{o=o.add(c.key)}),o}containsKey(e){let t=new te(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},te=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return L.comparator(e.key,t.key)||B(e.Hr,t.Hr)}static Ur(e,t){return B(e.Hr,t.Hr)||L.comparator(e.key,t.key)}};var ca=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new me(te.Qr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let c=new jo(o,t,r,s);this.mutationQueue.push(c);for(let l of s)this.Yr=this.Yr.add(new te(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(c)}lookupMutationBatch(e,t){return R.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,s=this.Xr(r),o=s<0?0:s;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?ja:this.er-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new te(t,0),s=new te(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,s],c=>{let l=this.Zr(c.Hr);o.push(l)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new me(B);return t.forEach(s=>{let o=new te(s,0),c=new te(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,c],l=>{r=r.add(l.Hr)})}),R.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,s=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let c=new te(new L(o),0),l=new me(B);return this.Yr.forEachWhile(h=>{let f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===s&&(l=l.add(h.Hr)),!0)},c),R.resolve(this.ei(l))}ei(e){let t=[];return e.forEach(r=>{let s=this.Zr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){J(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return R.forEach(t.mutations,s=>{let o=new te(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new te(t,0),s=this.Yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ua=class{constructor(e){this.ni=e,this.docs=(function(){return new Te(L.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,s=this.docs.get(r),o=s?s.size:0,c=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():cn.newInvalidDocument(t))}getEntries(e,t){let r=Ti();return t.forEach(s=>{let o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():cn.newInvalidDocument(s))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let o=Ti(),c=t.path,l=new L(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){let{key:f,value:{document:v}}=h.getNext();if(!c.isPrefixOf(f.path))break;f.path.length>c.length+1||Vg(Og(v),r)<=0||(s.has(v.key)||Xa(t,v))&&(o=o.insert(v.key,v.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,s){x(9500)}ri(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new la(this)}getSize(e){return R.resolve(this.size)}},la=class extends na{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var ha=class{constructor(e){this.persistence=e,this.ii=new Ke(t=>Ja(t),Ya),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.si=0,this.oi=new ur,this.targetCount=0,this._i=cr.ar()}forEachTarget(e,t){return this.ii.forEach((r,s)=>t(s)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),R.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new cr(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.hr(t),R.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let s=0,o=[];return this.ii.forEach((c,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.ii.delete(c),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),R.waitFor(o).next(()=>s)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(c=>{o.push(s.markPotentiallyOrphaned(e,c))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.oi.containsKey(t))}};var Si=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new oh(0),this.ci=!1,this.ci=!0,this.li=new aa,this.referenceDelegate=e(this),this.hi=new ha(this),this.indexManager=new Yo,this.remoteDocumentCache=(function(s){return new ua(s)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new Jo(t),this.Ti=new sa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new oa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new ca(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){D("MemoryPersistence","Starting transaction:",e);let s=new da(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(o=>this.referenceDelegate.di(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ei(e,t){return R.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},da=class extends bo{constructor(e){super(),this.currentSequenceNumber=e}},fa=class n{constructor(e){this.persistence=e,this.Ai=new ur,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw x(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(s=>this.mi.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.mi,r=>{let s=L.fromPath(r);return this.fi(e,s).next(o=>{o||t.removeEntry(s,Q.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return R.or([()=>R.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Ri=class n{constructor(e,t){this.persistence=e,this.gi=new Ke(r=>Fg(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=D_(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return R.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(o=>o?R.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ri(e,c=>this.Sr(e,c,t).next(l=>{l||(r++,o.removeEntry(c,Q.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),R.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fi(e.data.value)),t}Sr(e,t,r){return R.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let s=this.gi.get(t);return R.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var pa=class n{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=s}static Es(e,t){let r=pe(),s=pe();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new n(e,t.fromCache,r,s)}};var ma=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ga=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return Au()?8:Lg(Ie())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,s){let o={result:null};return this.ps(e,t).next(c=>{o.result=c}).next(()=>{if(!o.result)return this.ys(e,t,s,r).next(c=>{o.result=c})}).next(()=>{if(o.result)return;let c=new ma;return this.ws(e,t,c).next(l=>{if(o.result=l,this.Rs)return this.Ss(e,t,c,l.size)})}).next(()=>o.result)}Ss(e,t,r,s){return r.documentReadCount<this.Vs?(Jt()<=M.DEBUG&&D("QueryEngine","SDK will not create cache indexes for query:",Yn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),R.resolve()):(Jt()<=M.DEBUG&&D("QueryEngine","Query:",Yn(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Jt()<=M.DEBUG&&D("QueryEngine","The SDK decides to create cache indexes for query:",Yn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,St(t))):R.resolve())}ps(e,t){if(xl(t))return R.resolve(null);let r=St(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Bo(t,null,"F"),r=St(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let c=pe(...o);return this.gs.getDocuments(e,c).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{let f=this.bs(t,l);return this.Ds(t,f,c,h.readTime)?this.ps(e,Bo(t,null,"F")):this.vs(e,f,t,h)}))})))}ys(e,t,r,s){return xl(t)||s.isEqual(Q.min())?R.resolve(null):this.gs.getDocuments(e,r).next(o=>{let c=this.bs(t,o);return this.Ds(t,c,r,s)?R.resolve(null):(Jt()<=M.DEBUG&&D("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Yn(t)),this.vs(e,c,t,Ng(s,ir)).next(l=>l))})}bs(e,t){let r=new me(r_(e));return t.forEach((s,o)=>{Xa(e,o)&&(r=r.add(o))}),r}Ds(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}ws(e,t,r){return Jt()<=M.DEBUG&&D("QueryEngine","Using full collection scan to execute query:",Yn(t)),this.gs.getDocumentsMatchingQuery(e,t,Ot.min(),r)}vs(e,t,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(o=>(t.forEach(c=>{o=o.insert(c.key,c)}),o))}};var N_="LocalStore";var _a=class{constructor(e,t,r,s){this.persistence=e,this.Cs=t,this.serializer=s,this.Fs=new Te(B),this.Ms=new Ke(o=>Ja(o),Ya),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ia(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function O_(n,e,t,r){return new _a(n,e,t,r)}async function Jh(n,e){let t=G(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let c=[],l=[],h=pe();for(let f of s){c.push(f.batchId);for(let v of f.mutations)h=h.add(v.key)}for(let f of o){l.push(f.batchId);for(let v of f.mutations)h=h.add(v.key)}return t.localDocuments.getDocuments(r,h).next(f=>({Bs:f,removedBatchIds:c,addedBatchIds:l}))})})}function V_(n,e){let t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let s=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return(function(l,h,f,v){let w=f.batch,b=w.keys(),C=R.resolve();return b.forEach(k=>{C=C.next(()=>v.getEntry(h,k)).next(V=>{let O=f.docVersions.get(k);J(O!==null,48541),V.version.compareTo(O)<0&&(w.applyToRemoteDocument(V,f),V.isValidDocument()&&(V.setReadTime(f.commitVersion),v.addEntry(V)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(h,w))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let h=pe();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h})(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function x_(n){let e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function L_(n,e){let t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ja),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var Pi=class{constructor(){this.activeTargetIds=u_()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ya=class{constructor(){this.Fo=new Pi,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Pi,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var va=class{xo(e){}shutdown(){}};var zl="ConnectivityMonitor",Ci=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){D(zl,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){D(zl,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var di=null;function Ia(){return di===null?di=(function(){return 268435456+Math.round(2147483648*Math.random())})():di++,"0x"+di.toString(16)}var po="RestConnection",M_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Ea=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===Ei?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,t,r,s,o){let c=Ia(),l=this.Go(e,t.toUriEncodedString());D(po,`Sending RPC '${e}' ${c}:`,l,r);let h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,s,o);let{host:f}=new URL(l),v=mt(f);return this.jo(e,l,h,r,v).then(w=>(D(po,`Received RPC '${e}' ${c}: `,w),w),w=>{throw rn(po,`RPC '${e}' ${c} failed with error: `,w,"url: ",l,"request:",r),w})}Jo(e,t,r,s,o,c){return this.Wo(e,t,r,s,o)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+_n})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,o)=>e[o]=s),r&&r.headers.forEach((s,o)=>e[o]=s)}Go(e,t){let r=M_[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var wa=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var fe="WebChannelConnection",Ta=class extends Ea{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,s,o){let c=Ia();return new Promise((l,h)=>{let f=new co;f.setWithCredentials(!0),f.listenOnce(uo.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case Jn.NO_ERROR:let w=f.getResponseJson();D(fe,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(w)),l(w);break;case Jn.TIMEOUT:D(fe,`RPC '${e}' ${c} timed out`),h(new N(S.DEADLINE_EXCEEDED,"Request time out"));break;case Jn.HTTP_ERROR:let b=f.getStatus();if(D(fe,`RPC '${e}' ${c} failed with status:`,b,"response text:",f.getResponseText()),b>0){let C=f.getResponseJson();Array.isArray(C)&&(C=C[0]);let k=C?.error;if(k&&k.status&&k.message){let V=(function(z){let F=z.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(F)>=0?F:S.UNKNOWN})(k.status);h(new N(V,k.message))}else h(new N(S.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new N(S.UNAVAILABLE,"Connection failed."));break;default:x(9055,{c_:e,streamId:c,l_:f.getLastErrorCode(),h_:f.getLastError()})}}finally{D(fe,`RPC '${e}' ${c} completed.`)}});let v=JSON.stringify(s);D(fe,`RPC '${e}' ${c} sending request:`,s),f.send(t,"POST",v,r,15)})}P_(e,t,r){let s=Ia(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=fo(),l=ho(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let v=o.join("");D(fe,`Creating RPC '${e}' stream ${s}: ${v}`,h);let w=c.createWebChannel(v,h);this.T_(w);let b=!1,C=!1,k=new wa({Ho:O=>{C?D(fe,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(b||(D(fe,`Opening RPC '${e}' stream ${s} transport.`),w.open(),b=!0),D(fe,`RPC '${e}' stream ${s} sending:`,O),w.send(O))},Yo:()=>w.close()}),V=(O,z,F)=>{O.listen(z,j=>{try{F(j)}catch(Y){setTimeout(()=>{throw Y},0)}})};return V(w,Qt.EventType.OPEN,()=>{C||(D(fe,`RPC '${e}' stream ${s} transport opened.`),k.s_())}),V(w,Qt.EventType.CLOSE,()=>{C||(C=!0,D(fe,`RPC '${e}' stream ${s} transport closed`),k.__(),this.I_(w))}),V(w,Qt.EventType.ERROR,O=>{C||(C=!0,rn(fe,`RPC '${e}' stream ${s} transport errored. Name:`,O.name,"Message:",O.message),k.__(new N(S.UNAVAILABLE,"The operation could not be completed")))}),V(w,Qt.EventType.MESSAGE,O=>{var z;if(!C){let F=O.data[0];J(!!F,16349);let j=F,Y=j?.error||((z=j[0])===null||z===void 0?void 0:z.error);if(Y){D(fe,`RPC '${e}' stream ${s} received error:`,Y);let De=Y.status,se=(function(g){let _=ee[g];if(_!==void 0)return __(_)})(De),I=Y.message;se===void 0&&(se=S.INTERNAL,I="Unknown error status: "+De+" with message "+Y.message),C=!0,k.__(new N(se,I)),w.close()}else D(fe,`RPC '${e}' stream ${s} received:`,F),k.a_(F)}}),V(l,lo.STAT_EVENT,O=>{O.stat===ui.PROXY?D(fe,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===ui.NOPROXY&&D(fe,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.o_()},0),k}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function mo(){return typeof document<"u"?document:null}function Mi(n){return new Go(n,!0)}var ki=class{constructor(e,t,r=1e3,s=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=s,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,t-r);s>0&&D("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var Wl="PersistentStream",Aa=class{constructor(e,t,r,s,o,c,l,h){this.Fi=e,this.w_=r,this.S_=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new ki(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===t&&this.W_(r,s)},r=>{e(()=>{let s=new N(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return D(Wl,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(D(Wl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var ba=class extends Aa{constructor(e,t,r,s,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,c),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return J(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,J(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){J(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=b_(e.writeResults,e.commitTime),r=en(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=w_(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>A_(this.serializer,r))};this.k_(t)}};var Sa=class{},Ra=class extends Sa{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new N(S.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Wo(e,Ho(t,r),s,o,c)).catch(o=>{throw o.name==="FirebaseError"?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new N(S.UNKNOWN,o.toString())})}Jo(e,t,r,s,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,l])=>this.connection.Jo(e,Ho(t,r),s,c,l,o)).catch(c=>{throw c.name==="FirebaseError"?(c.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new N(S.UNKNOWN,c.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},Pa=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Nt(t),this._a=!1):D("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var fr="RemoteStore",Ca=class{constructor(e,t,r,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(c=>{r.enqueueAndForget(async()=>{mr(this)&&(D(fr,"Restarting streams for network reachability change."),await(async function(h){let f=G(h);f.Ia.add(4),await pr(f),f.Aa.set("Unknown"),f.Ia.delete(4),await Fi(f)})(this))})}),this.Aa=new Pa(r,s)}};async function Fi(n){if(mr(n))for(let e of n.da)await e(!0)}async function pr(n){for(let e of n.da)await e(!1)}function mr(n){return G(n).Ia.size===0}async function Yh(n,e,t){if(!dr(e))throw e;n.Ia.add(1),await pr(n),n.Aa.set("Offline"),t||(t=()=>x_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{D(fr,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Fi(n)})}function Xh(n,e){return e().catch(t=>Yh(n,t,e))}async function Ui(n){let e=G(n),t=ct(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:ja;for(;F_(e);)try{let s=await L_(e.localStore,r);if(s===null){e.Pa.length===0&&t.B_();break}r=s.batchId,U_(e,s)}catch(s){await Yh(e,s)}Zh(e)&&ed(e)}function F_(n){return mr(n)&&n.Pa.length<10}function U_(n,e){n.Pa.push(e);let t=ct(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Zh(n){return mr(n)&&!ct(n).M_()&&n.Pa.length>0}function ed(n){ct(n).start()}async function B_(n){ct(n).na()}async function q_(n){let e=ct(n);for(let t of n.Pa)e.X_(t.mutations)}async function $_(n,e,t){let r=n.Pa.shift(),s=zo.from(r,e,t);await Xh(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Ui(n)}async function j_(n,e){e&&ct(n).Z_&&await(async function(r,s){if((function(c){return g_(c)&&c!==S.ABORTED})(s.code)){let o=r.Pa.shift();ct(r).N_(),await Xh(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),await Ui(r)}})(n,e),Zh(n)&&ed(n)}async function Gl(n,e){let t=G(n);t.asyncQueue.verifyOperationInProgress(),D(fr,"RemoteStore received new credentials");let r=mr(t);t.Ia.add(3),await pr(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Fi(t)}async function z_(n,e){let t=G(n);e?(t.Ia.delete(2),await Fi(t)):e||(t.Ia.add(2),await pr(t),t.Aa.set("Unknown"))}function ct(n){return n.ma||(n.ma=(function(t,r,s){let o=G(t);return o.ia(),new ba(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:B_.bind(null,n),n_:j_.bind(null,n),ea:q_.bind(null,n),ta:$_.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await Ui(n)):(await n.ma.stop(),n.Pa.length>0&&(D(fr,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}var ka=class n{constructor(e,t,r,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,o){let c=Date.now()+r,l=new n(e,t,c,s,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function td(n,e){if(Nt("AsyncQueue",`${e}: ${n}`),dr(n))return new N(S.UNAVAILABLE,`${e}: ${n}`);throw n}var Da=class{constructor(){this.queries=Kl(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let s=G(t),o=s.queries;s.queries=Kl(),o.forEach((c,l)=>{for(let h of l.wa)h.onError(r)})})(this,new N(S.ABORTED,"Firestore shutting down"))}};function Kl(){return new Ke(n=>Lh(n),xh)}function W_(n){n.Da.forEach(e=>{e.next()})}var Hl,Ql;(Ql=Hl||(Hl={})).Fa="default",Ql.Cache="cache";var G_="SyncEngine";var Na=class{constructor(e,t,r,s,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new Ke(l=>Lh(l),xh),this.Tu=new Map,this.Iu=new Set,this.du=new Te(L.comparator),this.Eu=new Map,this.Au=new ur,this.Ru={},this.Vu=new Map,this.mu=cr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function K_(n,e,t){let r=Y_(n);try{let s=await(function(c,l){let h=G(c),f=ie.now(),v=l.reduce((C,k)=>C.add(k.key),pe()),w,b;return h.persistence.runTransaction("Locally write mutations","readwrite",C=>{let k=Ti(),V=pe();return h.Os.getEntries(C,v).next(O=>{k=O,k.forEach((z,F)=>{F.isValidDocument()||(V=V.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(C,k)).next(O=>{w=O;let z=[];for(let F of l){let j=m_(F,w.get(F.key).overlayedDocument);j!=null&&z.push(new He(F.key,j,Ch(j.value.mapValue),Rt.exists(!0)))}return h.mutationQueue.addMutationBatch(C,f,z,l)}).next(O=>{b=O;let z=O.applyToLocalDocumentSet(w,V);return h.documentOverlayCache.saveOverlays(C,O.batchId,z)})}).then(()=>({batchId:b.batchId,changes:Fh(w)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(c,l,h){let f=c.Ru[c.currentUser.toKey()];f||(f=new Te(B)),f=f.insert(l,h),c.Ru[c.currentUser.toKey()]=f})(r,s.batchId,t),await Bi(r,s.changes),await Ui(r.remoteStore)}catch(s){let o=td(s,"Failed to persist write");t.reject(o)}}function Jl(n,e,t){let r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let s=[];r.Pu.forEach((o,c)=>{let l=c.view.va(e);l.snapshot&&s.push(l.snapshot)}),(function(c,l){let h=G(c);h.onlineState=l;let f=!1;h.queries.forEach((v,w)=>{for(let b of w.wa)b.va(l)&&(f=!0)}),f&&W_(h)})(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function H_(n,e){let t=G(n),r=e.batch.batchId;try{let s=await V_(t.localStore,e);rd(t,r,null),nd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Bi(t,s)}catch(s){await $a(s)}}async function Q_(n,e,t){let r=G(n);try{let s=await(function(c,l){let h=G(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let v;return h.mutationQueue.lookupMutationBatch(f,l).next(w=>(J(w!==null,37113),v=w.keys(),h.mutationQueue.removeMutationBatch(f,w))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,v,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,v)).next(()=>h.localDocuments.getDocuments(f,v))})})(r.localStore,e);rd(r,e,t),nd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Bi(r,s)}catch(s){await $a(s)}}function nd(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function rd(n,e,t){let r=G(n),s=r.Ru[r.currentUser.toKey()];if(s){let o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}async function Bi(n,e,t){let r=G(n),s=[],o=[],c=[];r.Pu.isEmpty()||(r.Pu.forEach((l,h)=>{c.push(r.gu(h,e,t).then(f=>{var v;if((f||t)&&r.isPrimaryClient){let w=f?!f.fromCache:(v=t?.targetChanges.get(h.targetId))===null||v===void 0?void 0:v.current;r.sharedClientState.updateQueryState(h.targetId,w?"current":"not-current")}if(f){s.push(f);let w=pa.Es(h.targetId,f);o.push(w)}}))}),await Promise.all(c),r.hu.J_(s),await(async function(h,f){let v=G(h);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>R.forEach(f,b=>R.forEach(b.Is,C=>v.persistence.referenceDelegate.addReference(w,b.targetId,C)).next(()=>R.forEach(b.ds,C=>v.persistence.referenceDelegate.removeReference(w,b.targetId,C)))))}catch(w){if(!dr(w))throw w;D(N_,"Failed to update sequence numbers: "+w)}for(let w of f){let b=w.targetId;if(!w.fromCache){let C=v.Fs.get(b),k=C.snapshotVersion,V=C.withLastLimboFreeSnapshotVersion(k);v.Fs=v.Fs.insert(b,V)}}})(r.localStore,o))}async function J_(n,e){let t=G(n);if(!t.currentUser.isEqual(e)){D(G_,"User change. New user:",e.toKey());let r=await Jh(t.localStore,e);t.currentUser=e,(function(o,c){o.Vu.forEach(l=>{l.forEach(h=>{h.reject(new N(S.CANCELLED,c))})}),o.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bi(t,r.Bs)}}function Y_(n){let e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=H_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q_.bind(null,e),e}var id=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Mi(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return O_(this.persistence,new ga,t.initialUser,this.serializer)}Du(t){return new Si(fa.Vi,this.serializer)}bu(t){return new ya}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Oa=class extends id{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){J(this.persistence.referenceDelegate instanceof Ri,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new ea(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?Se.withCacheSize(this.cacheSizeBytes):Se.DEFAULT;return new Si(r=>Ri.Vi(r,t),this.serializer)}};var X_=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Jl(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=J_.bind(null,this.syncEngine),await z_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Da})()}createDatastore(t){let r=Mi(t.databaseInfo.databaseId),s=(function(c){return new Ta(c)})(t.databaseInfo);return(function(c,l,h,f){return new Ra(c,l,h,f)})(t.authCredentials,t.appCheckCredentials,s,r)}createRemoteStore(t){return(function(s,o,c,l,h){return new Ca(s,o,c,l,h)})(this.localStore,this.datastore,t.asyncQueue,r=>Jl(this.syncEngine,r,0),(function(){return Ci.C()?new Ci:new va})())}createSyncEngine(t,r){return(function(o,c,l,h,f,v,w){let b=new Na(o,c,l,h,f,v);return w&&(b.fu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(o){let c=G(o);D(fr,"RemoteStore shutting down."),c.Ia.add(5),await pr(c),c.Ea.shutdown(),c.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();var ut="FirestoreClient",Va=class{constructor(e,t,r,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=oe.UNAUTHENTICATED,this.clientId=rr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async c=>{D(ut,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(r,c=>(D(ut,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=td(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function go(n,e){n.asyncQueue.verifyOperationInProgress(),D(ut,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Jh(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{rn("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{D("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{rn("Terminating Firestore due to IndexedDb database deletion failed",s)})}),n._offlineComponents=e}async function Yl(n,e){n.asyncQueue.verifyOperationInProgress();let t=await Z_(n);D(ut,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Gl(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Gl(e.remoteStore,s)),n._onlineComponents=e}async function Z_(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){D(ut,"Using user provided OfflineComponentProvider");try{await go(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===S.FAILED_PRECONDITION||s.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;rn("Error using user provided cache. Falling back to memory cache: "+t),await go(n,new id)}}else D(ut,"Using default OfflineComponentProvider"),await go(n,new Oa(void 0));return n._offlineComponents}async function ey(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(D(ut,"Using user provided OnlineComponentProvider"),await Yl(n,n._uninitializedComponentsProvider._online)):(D(ut,"Using default OnlineComponentProvider"),await Yl(n,new X_))),n._onlineComponents}function ty(n){return ey(n).then(e=>e.syncEngine)}function sd(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Xl=new Map;var od="firestore.googleapis.com",Zl=!0,Di=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new N(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=od,this.ssl=Zl}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Zl;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Qh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<k_)throw new N(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Dg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sd((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},gn=class{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Di({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new N(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new N(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Di(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new _o;switch(r.type){case"firstParty":return new Eo(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new N(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Xl.get(t);r&&(D("ComponentProvider","Removing Datastore"),Xl.delete(t),r.terminate())})(this),Promise.resolve()}};function ad(n,e,t,r={}){var s;n=sh(n,gn);let o=mt(e),c=n._getSettings(),l=Object.assign(Object.assign({},c),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;o&&(Ts(`https://${h}`),As("Firestore",!0)),c.host!==od&&c.host!==h&&rn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let f=Object.assign(Object.assign({},c),{host:h,ssl:o,emulatorOptions:r});if(!gt(f,l)&&(n._setSettings(f),r.mockUserToken)){let v,w;if(typeof r.mockUserToken=="string")v=r.mockUserToken,w=oe.MOCK_USER;else{v=vu(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);let b=r.mockUserToken.sub||r.mockUserToken.user_id;if(!b)throw new N(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new oe(b)}n._authCredentials=new yo(new gi(v,w))}}var xa=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},we=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new st(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(hr(t,n._jsonSchema))return new n(e,r||null,new L(Z.fromString(t.referencePath)))}};we._jsonSchemaVersion="firestore/documentReference/1.0",we._jsonSchema={type:re("string",we._jsonSchemaVersion),referencePath:re("string")};var st=class n extends xa{constructor(e,t,r){super(e,t,e_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new we(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function cd(n,e,...t){if(n=be(n),rh("collection","path",e),n instanceof gn){let r=Z.fromString(e,...t);return bl(r),new st(n,null,r)}{if(!(n instanceof we||n instanceof st))throw new N(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Z.fromString(e,...t));return bl(r),new st(n.firestore,null,r)}}function ud(n,e,...t){if(n=be(n),arguments.length===1&&(e=rr.newId()),rh("doc","path",e),n instanceof gn){let r=Z.fromString(e,...t);return Al(r),new we(n,null,new L(r))}{if(!(n instanceof we||n instanceof st))throw new N(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Z.fromString(e,...t));return Al(r),new we(n.firestore,n instanceof st?n.converter:null,new L(r))}}var eh="AsyncQueue",Ni=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new ki(this,"async_queue_retry"),this.oc=()=>{let r=mo();r&&D(eh,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=mo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=mo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new We;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!dr(e))throw e;D(eh,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Nt("INTERNAL UNHANDLED ERROR: ",th(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let s=ka.createAndSchedule(this,e,t,r,o=>this.lc(o));return this.ec.push(s),s}ac(){this.tc&&x(47125,{hc:th(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function th(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Oi=class extends gn{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Ni,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ni(e),this._firestoreClient=void 0,await e}}};function ld(n,e){let t=typeof n=="object"?n:Gt(),r=typeof n=="string"?n:e||Ei,s=jr(t,"firestore").getImmediate({identifier:r});if(!s._initialized){let o=_u("firestore");o&&ad(s,...o)}return s}function ny(n){if(n._terminated)throw new N(S.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ry(n),n._firestoreClient}function ry(n){var e,t,r;let s=n._freezeSettings(),o=(function(l,h,f,v){return new Ro(l,h,f,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,sd(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new Va(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(l){let h=l?._online.build();return{_offline:l?._offline.build(h),_online:h}})(n._componentsProvider))}var Pt=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ge.fromBase64String(e))}catch(t){throw new N(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ge.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(hr(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Pt._jsonSchemaVersion="firestore/bytes/1.0",Pt._jsonSchema={type:re("string",Pt._jsonSchemaVersion),bytes:re("string")};var lr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ee(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Vi=class{constructor(e){this._methodName=e}};var Ct=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return B(this._lat,e._lat)||B(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(hr(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Ct._jsonSchemaVersion="firestore/geoPoint/1.0",Ct._jsonSchema={type:re("string",Ct._jsonSchemaVersion),latitude:re("number"),longitude:re("number")};var kt=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(hr(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new N(S.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};kt._jsonSchemaVersion="firestore/vectorValue/1.0",kt._jsonSchema={type:re("string",kt._jsonSchemaVersion),vectorValues:re("object")};var iy=/^__.*__$/,La=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new He(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ft(e,this.data,t,this.fieldTransforms)}};function hd(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw x(40011,{Ec:n})}}var Ma=class n{constructor(e,t,r,s,o,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return xi(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(hd(this.Ec)&&iy.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},Fa=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Mi(e)}Dc(e,t,r,s=!1){return new Ma({Ec:e,methodName:t,bc:r,path:Ee.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function sy(n){let e=n._freezeSettings(),t=Mi(n._databaseId);return new Fa(n._databaseId,!!e.ignoreUndefinedProperties,t)}function oy(n,e,t,r,s,o={}){let c=n.Dc(o.merge||o.mergeFields?2:0,e,t,s);md("Data must be an object, but it was:",c,r);let l=fd(r,c),h,f;if(o.merge)h=new Le(c.fieldMask),f=c.fieldTransforms;else if(o.mergeFields){let v=[];for(let w of o.mergeFields){let b=ay(e,w,t);if(!c.contains(b))throw new N(S.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);uy(v,b)||v.push(b)}h=new Le(v),f=c.fieldTransforms.filter(w=>h.covers(w.field))}else h=null,f=c.fieldTransforms;return new La(new xe(l),h,f)}function dd(n,e){if(pd(n=be(n)))return md("Unsupported field value:",e,n),fd(n,e);if(n instanceof Vi)return(function(r,s){if(!hd(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,s){let o=[],c=0;for(let l of r){let h=dd(l,s.yc(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}})(n,e)}return(function(r,s){if((r=be(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return l_(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ie.fromDate(r);return{timestampValue:Ko(s.serializer,o)}}if(r instanceof ie){let o=new ie(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ko(s.serializer,o)}}if(r instanceof Ct)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pt)return{bytesValue:y_(s.serializer,r._byteString)};if(r instanceof we){let o=s.databaseId,c=r.firestore._databaseId;if(!c.isEqual(o))throw s.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Kh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof kt)return(function(c,l){return{mapValue:{fields:{[Ka]:{stringValue:Ha},[or]:{arrayValue:{values:c.toArray().map(f=>{if(typeof f!="number")throw l.wc("VectorValues must only contain numeric values.");return Za(l.serializer,f)})}}}}}})(r,s);throw s.wc(`Unsupported field value: ${qa(r)}`)})(n,e)}function fd(n,e){let t={};return Eh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yn(n,(r,s)=>{let o=dd(s,e.Vc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function pd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ie||n instanceof Ct||n instanceof Pt||n instanceof we||n instanceof Vi||n instanceof kt)}function md(n,e,t){if(!pd(t)||!ih(t)){let r=qa(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function ay(n,e,t){if((e=be(e))instanceof lr)return e._internalPath;if(typeof e=="string")return gd(n,e);throw xi("Field path arguments must be of type string or ",n,!1,void 0,t)}var cy=new RegExp("[~\\*/\\[\\]]");function gd(n,e,t){if(e.search(cy)>=0)throw xi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lr(...e.split("."))._internalPath}catch{throw xi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xi(n,e,t,r,s){let o=r&&!r.isEmpty(),c=s!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${r}`),c&&(h+=` in document ${s}`),h+=")"),new N(S.INVALID_ARGUMENT,l+n+h)}function uy(n,e){return n.some(t=>t.isEqual(e))}var Li=class{constructor(e,t,r,s,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new we(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ua(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(_d("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ua=class extends Li{data(){return super.data()}};function _d(n,e){return typeof e=="string"?gd(n,e):e instanceof lr?e._internalPath:e._delegate._internalPath}function ly(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Zt=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},tn=class n extends Li{constructor(e,t,r,s,o,c){super(e,t,r,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new nn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(_d("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new N(S.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};tn._jsonSchemaVersion="firestore/documentSnapshot/1.0",tn._jsonSchema={type:re("string",tn._jsonSchemaVersion),bundleSource:re("string","DocumentSnapshot"),bundleName:re("string"),bundle:re("string")};var nn=class extends tn{data(e={}){return super.data(e)}},nr=class n{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Zt(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new nn(this._firestore,this._userDataWriter,r.key,r,new Zt(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map(l=>{let h=new nn(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Zt(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{let h=new nn(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Zt(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter),f=-1,v=-1;return l.type!==0&&(f=c.indexOf(l.doc.key),c=c.delete(l.doc.key)),l.type!==1&&(c=c.add(l.doc),v=c.indexOf(l.doc.key)),{type:hy(l.type),doc:h,oldIndex:f,newIndex:v}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new N(S.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=rr.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],s=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function hy(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return x(61501,{type:n})}}nr._jsonSchemaVersion="firestore/querySnapshot/1.0",nr._jsonSchema={type:re("string",nr._jsonSchemaVersion),bundleSource:re("string","QuerySnapshot"),bundleName:re("string"),bundle:re("string")};function yd(n,e){let t=sh(n.firestore,Oi),r=ud(n),s=ly(n.converter,e);return dy(t,[oy(sy(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Rt.exists(!1))]).then(()=>r)}function dy(n,e){return(function(r,s){let o=new We;return r.asyncQueue.enqueueAndForget(async()=>K_(await ty(r),s,o)),o.promise})(ny(n),e)}(function(e,t=!0){(function(s){_n=s})(Wt),Ce(new ye("firestore",(r,{instanceIdentifier:s,options:o})=>{let c=r.getProvider("app").getImmediate(),l=new Oi(new vo(r.getProvider("auth-internal")),new wo(c,r.getProvider("app-check-internal")),(function(f,v){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new N(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Po(f.options.projectId,v)})(c,s),c);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),X(Il,El,e),X(Il,El,"esm2017")})();var gr=class{constructor(e){return e}},vd="firestore",ec=class{constructor(){return Ht(vd)}};var tc=new Vr("angularfire2.firestore-instances");function fy(n,e){let t=Gr(vd,n,e);return t&&new gr(t)}function py(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new gr(r)}}var my={provide:ec,deps:[[new et,tc]]},gy={provide:gr,useFactory:fy,deps:[[new et,tc],Et]};function Aw(n,...e){return X("angularfire",vt.full,"fst"),xr([gy,my,{provide:tc,useFactory:py(n),multi:!0,deps:[Ze,zt,It,jn,[new et,oi],[new et,Hr],...e]}])}var bw=nt(yd,!0,2);var Sw=nt(cd,!0,2);var Rw=nt(ld,!0);export{Xy as a,yv as b,vv as c,gr as d,Aw as e,bw as f,Sw as g,Rw as h};
